<!DOCTYPE html><!--n_OaHVlfcIetbxWrGFmpn--><html><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="/_next/static/css/b2aa10a3cb761d2f.css" data-precedence="next"/><link rel="preload" as="script" fetchPriority="low" href="/_next/static/chunks/webpack-cc328fc80d1d92f9.js"/><script src="/_next/static/chunks/eecf3333-be88052a8c8f8697.js" async=""></script><script src="/_next/static/chunks/4752-58b380405a07aaf7.js" async=""></script><script src="/_next/static/chunks/main-app-b80276bf8fc0d295.js" async=""></script><script src="/_next/static/chunks/6752-90baefdcb051c3c1.js" async=""></script><script src="/_next/static/chunks/2346-8f59889a5170c5da.js" async=""></script><script src="/_next/static/chunks/app/not-found-ffca88c5e945e772.js" async=""></script><script src="/_next/static/chunks/1909-ac3fe94adcf1a95e.js" async=""></script><script src="/_next/static/chunks/1278-1b71cee32080193b.js" async=""></script><script src="/_next/static/chunks/1399-c867858dd6d3be69.js" async=""></script><script src="/_next/static/chunks/app/%5Blocale%5D/layout-41f8cce3b90dae17.js" async=""></script><script src="/_next/static/chunks/8267-dd1b836d6e85c2aa.js" async=""></script><script src="/_next/static/chunks/4078-f6abe0d6c13465e4.js" async=""></script><script src="/_next/static/chunks/app/%5Blocale%5D/docs/%5Bslug%5D/page-1401b27bc56f3599.js" async=""></script><meta name="author" content="Metasequoia AI Studio"/><link rel="manifest" href="/manifest.json"/><meta name="theme-color" content="#000000"/><title>本地知识库搭建指南 | 文档中心</title><meta name="description" content="学习如何构建企业级本地知识库，实现私有数据的智能检索与问答"/><link rel="canonical" href="/en/docs/knowledge-base"/><meta property="og:title" content="Metasequoia Studio"/><meta property="og:description" content="Providing customers with large model privatization deployment, application development and intelligent agent customization services"/><meta property="og:image" content="http://localhost:3000/favicon.jpg"/><meta property="og:type" content="website"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:title" content="Metasequoia Studio"/><meta name="twitter:description" content="Providing customers with large model privatization deployment, application development and intelligent agent customization services"/><meta name="twitter:image" content="http://localhost:3000/favicon.jpg"/><link rel="icon" href="/favicon.jpg"/><script src="/_next/static/chunks/polyfills-42372ed130431b0a.js" noModule=""></script></head><body class="antialiased"><div hidden=""><!--$--><!--/$--></div><html lang="en"><head></head><body class="antialiased"><div class="flex flex-col min-h-screen"><header class="fixed top-0 left-0 right-0 z-50 transition-all duration-300 bg-transparent"><div class="container mx-auto px-4 sm:px-6 lg:px-8"><div class="flex justify-between items-center h-16 lg:h-20"><a class="flex items-center gap-3 group" href="/zh/"><div class="relative w-9 h-9 rounded-xl overflow-hidden shadow-card group-hover:shadow-glow transition-shadow duration-300"><img alt="Logo" draggable="false" loading="lazy" decoding="async" data-nimg="fill" class="object-cover" style="position:absolute;height:100%;width:100%;left:0;top:0;right:0;bottom:0;color:transparent" src="/favicon.jpg"/></div><span class="text-lg font-bold gradient-text hidden sm:block">Metasequoia AI</span></a><nav class="hidden lg:flex items-center gap-1"><a class="relative px-4 py-2 text-sm font-medium transition-colors rounded-lg text-slate-600 dark:text-slate-300 hover:text-slate-900 dark:hover:text-white" href="/zh/">Home</a><a class="relative px-4 py-2 text-sm font-medium transition-colors rounded-lg text-slate-600 dark:text-slate-300 hover:text-slate-900 dark:hover:text-white" href="/zh/services/">Services</a><a class="relative px-4 py-2 text-sm font-medium transition-colors rounded-lg text-slate-600 dark:text-slate-300 hover:text-slate-900 dark:hover:text-white" href="/zh/store/">Store</a><a class="relative px-4 py-2 text-sm font-medium transition-colors rounded-lg text-slate-600 dark:text-slate-300 hover:text-slate-900 dark:hover:text-white" href="/zh/docs/">Docs</a><a class="relative px-4 py-2 text-sm font-medium transition-colors rounded-lg text-slate-600 dark:text-slate-300 hover:text-slate-900 dark:hover:text-white" href="/zh/contact/">Contact</a></nav><div class="flex items-center gap-2"><button class="hidden lg:flex items-center gap-2 px-3 py-2 text-sm font-medium text-slate-600 dark:text-slate-300 hover:text-slate-900 dark:hover:text-white hover:bg-slate-100 dark:hover:bg-slate-800 rounded-lg transition-all group"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="w-4 h-4"><path stroke-linecap="round" stroke-linejoin="round" d="m21 21-5.197-5.197m0 0A7.5 7.5 0 1 0 5.196 5.196a7.5 7.5 0 0 0 10.607 10.607Z"></path></svg><span class="text-slate-400 dark:text-slate-500 group-hover:text-slate-600 dark:group-hover:text-slate-300">Search</span><kbd class="hidden xl:inline-flex items-center gap-1 px-1.5 py-0.5 text-xs font-sans bg-slate-100 dark:bg-slate-800 text-slate-500 dark:text-slate-400 rounded border border-slate-200 dark:border-slate-700"><span>⌘</span><span>K</span></kbd></button><button class="lg:hidden p-2 text-slate-600 dark:text-slate-300 hover:text-slate-900 dark:hover:text-white hover:bg-slate-100 dark:hover:bg-slate-800 rounded-lg transition-all" aria-label="Search"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="w-5 h-5"><path stroke-linecap="round" stroke-linejoin="round" d="m21 21-5.197-5.197m0 0A7.5 7.5 0 1 0 5.196 5.196a7.5 7.5 0 0 0 10.607 10.607Z"></path></svg></button><div class="relative dropdown-container hidden sm:block"><button class="flex items-center gap-2 px-3 py-2 text-sm font-medium text-slate-600 dark:text-slate-300 hover:text-slate-900 dark:hover:text-white hover:bg-slate-100 dark:hover:bg-slate-800 rounded-lg transition-all"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="w-4 h-4"><path stroke-linecap="round" stroke-linejoin="round" d="M12 3v2.25m6.364.386-1.591 1.591M21 12h-2.25m-.386 6.364-1.591-1.591M12 18.75V21m-4.773-4.227-1.591 1.591M5.25 12H3m4.227-4.773L5.636 5.636M15.75 12a3.75 3.75 0 1 1-7.5 0 3.75 3.75 0 0 1 7.5 0Z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="w-4 h-4 transition-transform "><path stroke-linecap="round" stroke-linejoin="round" d="m19.5 8.25-7.5 7.5-7.5-7.5"></path></svg></button></div><div class="relative dropdown-container hidden sm:block"><button class="flex items-center gap-2 px-3 py-2 text-sm font-medium text-slate-600 dark:text-slate-300 hover:text-slate-900 dark:hover:text-white hover:bg-slate-100 dark:hover:bg-slate-800 rounded-lg transition-all"><span class="uppercase font-semibold text-xs">zh</span><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="w-4 h-4 transition-transform "><path stroke-linecap="round" stroke-linejoin="round" d="m19.5 8.25-7.5 7.5-7.5-7.5"></path></svg></button></div><a class="hidden lg:flex items-center gap-2 px-4 py-2 bg-primary hover:bg-primary-600 text-white text-sm font-medium rounded-xl transition-all hover:shadow-glow btn-shine" href="/zh/contact/">Get Started</a><button class="lg:hidden p-2 text-slate-600 dark:text-slate-300 hover:text-slate-900 dark:hover:text-white hover:bg-slate-100 dark:hover:bg-slate-800 rounded-lg transition-all" aria-label="Toggle menu"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="w-6 h-6"><path stroke-linecap="round" stroke-linejoin="round" d="M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25h16.5"></path></svg></button></div></div></div></header><main class="flex-grow"><div class="min-h-screen bg-slate-50 dark:bg-slate-900 pt-20"><header class="fixed top-16 lg:top-20 left-0 right-0 z-30 bg-white/80 dark:bg-slate-900/80 backdrop-blur-xl border-b border-slate-200 dark:border-slate-700"><div class="container mx-auto px-4 sm:px-6 lg:px-8"><div class="flex items-center justify-between h-14"><a class="flex items-center gap-2 text-slate-500 hover:text-indigo-600 transition-colors group" href="/zh/docs/"><div class="w-8 h-8 rounded-lg bg-slate-100 dark:bg-slate-800 flex items-center justify-center group-hover:bg-indigo-100 dark:group-hover:bg-indigo-900/30 transition-colors"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="w-4 h-4"><path stroke-linecap="round" stroke-linejoin="round" d="M10.5 19.5 3 12m0 0 7.5-7.5M3 12h18"></path></svg></div><span class="text-sm font-medium">返回文档列表</span></a><nav class="hidden sm:flex items-center gap-2 text-sm text-slate-500"><a class="hover:text-indigo-600 transition-colors" href="/zh/">首页</a><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="w-3 h-3"><path stroke-linecap="round" stroke-linejoin="round" d="m8.25 4.5 7.5 7.5-7.5 7.5"></path></svg><a class="hover:text-indigo-600 transition-colors" href="/zh/docs/">文档中心</a><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="w-3 h-3"><path stroke-linecap="round" stroke-linejoin="round" d="m8.25 4.5 7.5 7.5-7.5 7.5"></path></svg><span class="text-slate-900 dark:text-white font-medium">进阶教程</span></nav></div></div></header><div class="container mx-auto px-4 sm:px-6 lg:px-8 py-8 lg:py-12"><div class="grid grid-cols-1 lg:grid-cols-12 gap-8"><aside class="hidden lg:block lg:col-span-3"><div class="sticky top-24 space-y-6"><div class="bg-white dark:bg-slate-800 rounded-2xl p-6 border border-slate-200 dark:border-slate-700 shadow-sm"><h3 class="text-sm font-semibold text-slate-900 dark:text-white mb-4 flex items-center gap-2"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="w-4 h-4 text-indigo-500"><path stroke-linecap="round" stroke-linejoin="round" d="M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25m0 12.75h7.5m-7.5 3H12M10.5 2.25H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z"></path></svg>文档导航</h3><nav class="space-y-4"><div><h4 class="text-xs font-medium text-slate-500 dark:text-slate-400 uppercase tracking-wider mb-2">开发指南</h4><ul class="space-y-1"><li><a class="block px-3 py-2 rounded-lg text-sm transition-colors text-slate-600 dark:text-slate-400 hover:bg-slate-100 dark:hover:bg-slate-700" href="/zh/docs/api-integration/">API 集成开发指南</a></li></ul></div><div><h4 class="text-xs font-medium text-slate-500 dark:text-slate-400 uppercase tracking-wider mb-2">技术文档</h4><ul class="space-y-1"><li><a class="block px-3 py-2 rounded-lg text-sm transition-colors text-slate-600 dark:text-slate-400 hover:bg-slate-100 dark:hover:bg-slate-700" href="/zh/docs/api-reference/">API 文档</a></li><li><a class="block px-3 py-2 rounded-lg text-sm transition-colors text-slate-600 dark:text-slate-400 hover:bg-slate-100 dark:hover:bg-slate-700" href="/zh/docs/model-deployment/">模型部署指南</a></li></ul></div><div><h4 class="text-xs font-medium text-slate-500 dark:text-slate-400 uppercase tracking-wider mb-2">帮助中心</h4><ul class="space-y-1"><li><a class="block px-3 py-2 rounded-lg text-sm transition-colors text-slate-600 dark:text-slate-400 hover:bg-slate-100 dark:hover:bg-slate-700" href="/zh/docs/faq/">常见问题</a></li></ul></div><div><h4 class="text-xs font-medium text-slate-500 dark:text-slate-400 uppercase tracking-wider mb-2">入门指南</h4><ul class="space-y-1"><li><a class="block px-3 py-2 rounded-lg text-sm transition-colors text-slate-600 dark:text-slate-400 hover:bg-slate-100 dark:hover:bg-slate-700" href="/zh/docs/introduction/">欢迎使用水杉智境工作室</a></li></ul></div><div><h4 class="text-xs font-medium text-slate-500 dark:text-slate-400 uppercase tracking-wider mb-2">进阶教程</h4><ul class="space-y-1"><li><a class="block px-3 py-2 rounded-lg text-sm transition-colors bg-indigo-50 dark:bg-indigo-900/30 text-indigo-600 dark:text-indigo-400 font-medium" href="/zh/docs/knowledge-base/">本地知识库搭建指南</a></li><li><a class="block px-3 py-2 rounded-lg text-sm transition-colors text-slate-600 dark:text-slate-400 hover:bg-slate-100 dark:hover:bg-slate-700" href="/zh/docs/prompt-engineering/">提示词工程最佳实践</a></li><li><a class="block px-3 py-2 rounded-lg text-sm transition-colors text-slate-600 dark:text-slate-400 hover:bg-slate-100 dark:hover:bg-slate-700" href="/zh/docs/workflow/">AI 工作流搭建实战</a></li></ul></div><div><h4 class="text-xs font-medium text-slate-500 dark:text-slate-400 uppercase tracking-wider mb-2">其他</h4><ul class="space-y-1"><li><a class="block px-3 py-2 rounded-lg text-sm transition-colors text-slate-600 dark:text-slate-400 hover:bg-slate-100 dark:hover:bg-slate-700" href="/zh/docs/privacy-policy-en/">privacy-policy-en</a></li><li><a class="block px-3 py-2 rounded-lg text-sm transition-colors text-slate-600 dark:text-slate-400 hover:bg-slate-100 dark:hover:bg-slate-700" href="/zh/docs/privacy-policy/">privacy-policy</a></li><li><a class="block px-3 py-2 rounded-lg text-sm transition-colors text-slate-600 dark:text-slate-400 hover:bg-slate-100 dark:hover:bg-slate-700" href="/zh/docs/terms-of-service-en/">terms-of-service-en</a></li><li><a class="block px-3 py-2 rounded-lg text-sm transition-colors text-slate-600 dark:text-slate-400 hover:bg-slate-100 dark:hover:bg-slate-700" href="/zh/docs/terms-of-service/">terms-of-service</a></li></ul></div></nav></div></div></aside><main class="lg:col-span-7"><div class="mb-8" style="opacity:0;transform:translateY(20px)"><div class="flex items-center gap-3 mb-6"><span class="inline-flex items-center gap-1.5 px-3 py-1.5 bg-indigo-50 dark:bg-indigo-900/30 text-indigo-600 dark:text-indigo-400 rounded-full text-sm font-medium"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="w-3.5 h-3.5"><path stroke-linecap="round" stroke-linejoin="round" d="M2.25 12.75V12A2.25 2.25 0 0 1 4.5 9.75h15A2.25 2.25 0 0 1 21.75 12v.75m-8.69-6.44-2.12-2.12a1.5 1.5 0 0 0-1.061-.44H4.5A2.25 2.25 0 0 0 2.25 6v12a2.25 2.25 0 0 0 2.25 2.25h15A2.25 2.25 0 0 0 21.75 18V9a2.25 2.25 0 0 0-2.25-2.25h-5.379a1.5 1.5 0 0 1-1.06-.44Z"></path></svg>进阶教程</span><span class="flex items-center gap-1.5 text-sm text-slate-500 dark:text-slate-400"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="w-4 h-4"><path stroke-linecap="round" stroke-linejoin="round" d="M12 6v6h4.5m4.5 0a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"></path></svg>更新于 <!-- -->2025-02-09</span></div><h1 class="text-3xl sm:text-4xl lg:text-5xl font-bold text-slate-900 dark:text-white mb-6 leading-tight">本地知识库搭建指南</h1><p class="text-lg text-slate-600 dark:text-slate-400 leading-relaxed">学习如何构建企业级本地知识库，实现私有数据的智能检索与问答</p><div class="flex items-center gap-2 mt-4"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="w-4 h-4 text-slate-400"><path stroke-linecap="round" stroke-linejoin="round" d="M9.568 3H5.25A2.25 2.25 0 0 0 3 5.25v4.318c0 .597.237 1.17.659 1.591l9.581 9.581c.699.699 1.78.872 2.607.33a18.095 18.095 0 0 0 5.223-5.223c.542-.827.369-1.908-.33-2.607L11.16 3.66A2.25 2.25 0 0 0 9.568 3Z"></path><path stroke-linecap="round" stroke-linejoin="round" d="M6 6h.008v.008H6V6Z"></path></svg><div class="flex flex-wrap gap-2"><span class="px-2.5 py-1 bg-slate-100 dark:bg-slate-700 text-slate-600 dark:text-slate-300 rounded-full text-xs font-medium">知识库</span><span class="px-2.5 py-1 bg-slate-100 dark:bg-slate-700 text-slate-600 dark:text-slate-300 rounded-full text-xs font-medium">RAG</span><span class="px-2.5 py-1 bg-slate-100 dark:bg-slate-700 text-slate-600 dark:text-slate-300 rounded-full text-xs font-medium">向量数据库</span><span class="px-2.5 py-1 bg-slate-100 dark:bg-slate-700 text-slate-600 dark:text-slate-300 rounded-full text-xs font-medium">数据安全</span></div></div></div><article class="bg-white dark:bg-slate-800 rounded-2xl p-8 lg:p-10 border border-slate-200 dark:border-slate-700 shadow-sm" style="opacity:0;transform:translateY(20px)"><div class="prose dark:prose-invert max-w-none "><h1 id="本地知识库搭建指南" class="text-3xl font-bold mb-8 text-slate-900 dark:text-white scroll-mt-24"><a href="#本地知识库搭建指南" class="text-indigo-600 dark:text-indigo-400 no-underline hover:underline">本地知识库搭建指南</a></h1>
<h2 id="概述" class="text-2xl font-semibold mt-12 mb-4 text-slate-900 dark:text-white border-b border-slate-200 dark:border-slate-700 pb-3 scroll-mt-24"><a href="#概述" class="text-indigo-600 dark:text-indigo-400 no-underline hover:underline">概述</a></h2>
<p class="text-slate-600 dark:text-slate-300 leading-relaxed mb-4">本地知识库（Local Knowledge Base）是企业 AI 应用的核心基础设施。通过将企业私有文档、数据转化为可检索的知识，结合大语言模型的理解能力，实现智能问答、文档分析、知识挖掘等功能。</p>
<h2 id="核心架构" class="text-2xl font-semibold mt-12 mb-4 text-slate-900 dark:text-white border-b border-slate-200 dark:border-slate-700 pb-3 scroll-mt-24"><a href="#核心架构" class="text-indigo-600 dark:text-indigo-400 no-underline hover:underline">核心架构</a></h2>
<pre><div class="my-6 p-4 bg-slate-50 dark:bg-slate-900 rounded-xl border border-slate-200 dark:border-slate-700 flex justify-center overflow-x-auto"></div></pre>
<h2 id="环境准备" class="text-2xl font-semibold mt-12 mb-4 text-slate-900 dark:text-white border-b border-slate-200 dark:border-slate-700 pb-3 scroll-mt-24"><a href="#环境准备" class="text-indigo-600 dark:text-indigo-400 no-underline hover:underline">环境准备</a></h2>
<h3 id="系统要求" class="text-xl font-semibold mt-8 mb-3 text-slate-800 dark:text-slate-200 scroll-mt-24"><a href="#系统要求" class="text-indigo-600 dark:text-indigo-400 no-underline hover:underline">系统要求</a></h3>
<ul class="my-6 space-y-2 list-disc list-inside">
<li class="text-slate-600 dark:text-slate-300 marker:text-indigo-500"><strong class="text-slate-900 dark:text-white font-semibold">CPU</strong>: 4核及以上</li>
<li class="text-slate-600 dark:text-slate-300 marker:text-indigo-500"><strong class="text-slate-900 dark:text-white font-semibold">内存</strong>: 16GB 及以上</li>
<li class="text-slate-600 dark:text-slate-300 marker:text-indigo-500"><strong class="text-slate-900 dark:text-white font-semibold">存储</strong>: 100GB SSD 及以上</li>
<li class="text-slate-600 dark:text-slate-300 marker:text-indigo-500"><strong class="text-slate-900 dark:text-white font-semibold">GPU</strong>: 可选，推荐用于 Embedding 加速</li>
</ul>
<h3 id="依赖安装" class="text-xl font-semibold mt-8 mb-3 text-slate-800 dark:text-slate-200 scroll-mt-24"><a href="#依赖安装" class="text-indigo-600 dark:text-indigo-400 no-underline hover:underline">依赖安装</a></h3>
<pre><div class="relative group my-6 rounded-xl overflow-hidden border bg-slate-50 border-slate-200"><div class="flex items-center justify-between px-4 py-2 border-b bg-white border-slate-200"><span class="text-xs uppercase font-semibold tracking-wider text-slate-500">bash</span><button class="flex items-center gap-1.5 px-3 py-1.5 text-xs font-medium rounded-lg transition-all text-slate-500 hover:text-slate-700 hover:bg-slate-200" aria-label="复制代码"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="w-3.5 h-3.5"><path stroke-linecap="round" stroke-linejoin="round" d="M15.666 3.888A2.25 2.25 0 0 0 13.5 2.25h-3c-1.03 0-1.9.693-2.166 1.638m7.332 0c.055.194.084.4.084.612v0a.75.75 0 0 1-.75.75H9a.75.75 0 0 1-.75-.75v0c0-.212.03-.418.084-.612m7.332 0c.646.049 1.288.11 1.927.184 1.1.128 1.907 1.077 1.907 2.185V19.5a2.25 2.25 0 0 1-2.25 2.25H6.75A2.25 2.25 0 0 1 4.5 19.5V6.257c0-1.108.806-2.057 1.907-2.185a48.208 48.208 0 0 1 1.927-.184"></path></svg><span>复制</span></button></div><div class="overflow-x-auto"><pre style="background:transparent;color:hsl(230, 8%, 24%);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.7;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1.25rem;margin:0;overflow:auto;border-radius:0.3em;font-size:0.875rem"><code class="language-bash" style="white-space:pre;background:transparent;color:hsl(230, 8%, 24%);font-family:ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, monospace;direction:ltr;text-align:left;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">1</span><span class="token" style="color:hsl(230, 4%, 64%);font-style:italic"># Python 环境</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">2</span><span>python -m pip </span><span class="token" style="color:hsl(221, 87%, 60%)">install</span><span> langchain langchain-community
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">3</span>
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">4</span><span></span><span class="token" style="color:hsl(230, 4%, 64%);font-style:italic"># 向量数据库</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">5</span><span>pip </span><span class="token" style="color:hsl(221, 87%, 60%)">install</span><span> pymilvus  </span><span class="token" style="color:hsl(230, 4%, 64%);font-style:italic"># 或 pgvector</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">6</span>
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">7</span><span></span><span class="token" style="color:hsl(230, 4%, 64%);font-style:italic"># 文档解析</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">8</span><span>pip </span><span class="token" style="color:hsl(221, 87%, 60%)">install</span><span> pypdf unstructured
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">9</span>
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">10</span><span></span><span class="token" style="color:hsl(230, 4%, 64%);font-style:italic"># Embedding 模型</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">11</span><span>pip </span><span class="token" style="color:hsl(221, 87%, 60%)">install</span><span> sentence-transformers</span></code></pre></div></div></pre>
<h2 id="快速开始" class="text-2xl font-semibold mt-12 mb-4 text-slate-900 dark:text-white border-b border-slate-200 dark:border-slate-700 pb-3 scroll-mt-24"><a href="#快速开始" class="text-indigo-600 dark:text-indigo-400 no-underline hover:underline">快速开始</a></h2>
<h3 id="1-初始化向量数据库" class="text-xl font-semibold mt-8 mb-3 text-slate-800 dark:text-slate-200 scroll-mt-24"><a href="#1-初始化向量数据库" class="text-indigo-600 dark:text-indigo-400 no-underline hover:underline">1. 初始化向量数据库</a></h3>
<p class="text-slate-600 dark:text-slate-300 leading-relaxed mb-4">使用 Milvus 作为向量存储：</p>
<pre><div class="relative group my-6 rounded-xl overflow-hidden border bg-slate-50 border-slate-200"><div class="flex items-center justify-between px-4 py-2 border-b bg-white border-slate-200"><span class="text-xs uppercase font-semibold tracking-wider text-slate-500">bash</span><button class="flex items-center gap-1.5 px-3 py-1.5 text-xs font-medium rounded-lg transition-all text-slate-500 hover:text-slate-700 hover:bg-slate-200" aria-label="复制代码"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="w-3.5 h-3.5"><path stroke-linecap="round" stroke-linejoin="round" d="M15.666 3.888A2.25 2.25 0 0 0 13.5 2.25h-3c-1.03 0-1.9.693-2.166 1.638m7.332 0c.055.194.084.4.084.612v0a.75.75 0 0 1-.75.75H9a.75.75 0 0 1-.75-.75v0c0-.212.03-.418.084-.612m7.332 0c.646.049 1.288.11 1.927.184 1.1.128 1.907 1.077 1.907 2.185V19.5a2.25 2.25 0 0 1-2.25 2.25H6.75A2.25 2.25 0 0 1 4.5 19.5V6.257c0-1.108.806-2.057 1.907-2.185a48.208 48.208 0 0 1 1.927-.184"></path></svg><span>复制</span></button></div><div class="overflow-x-auto"><pre style="background:transparent;color:hsl(230, 8%, 24%);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.7;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1.25rem;margin:0;overflow:auto;border-radius:0.3em;font-size:0.875rem"><code class="language-bash" style="white-space:pre;background:transparent;color:hsl(230, 8%, 24%);font-family:ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, monospace;direction:ltr;text-align:left;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">1</span><span class="token" style="color:hsl(230, 4%, 64%);font-style:italic"># Docker 启动 Milvus</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">2</span><span></span><span class="token" style="color:hsl(221, 87%, 60%)">docker-compose</span><span> -f milvus-standalone-docker-compose.yml up -d</span></code></pre></div></div></pre>
<p class="text-slate-600 dark:text-slate-300 leading-relaxed mb-4">或使用 PostgreSQL + pgvector：</p>
<pre><div class="relative group my-6 rounded-xl overflow-hidden border bg-slate-50 border-slate-200"><div class="flex items-center justify-between px-4 py-2 border-b bg-white border-slate-200"><span class="text-xs uppercase font-semibold tracking-wider text-slate-500">sql</span><button class="flex items-center gap-1.5 px-3 py-1.5 text-xs font-medium rounded-lg transition-all text-slate-500 hover:text-slate-700 hover:bg-slate-200" aria-label="复制代码"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="w-3.5 h-3.5"><path stroke-linecap="round" stroke-linejoin="round" d="M15.666 3.888A2.25 2.25 0 0 0 13.5 2.25h-3c-1.03 0-1.9.693-2.166 1.638m7.332 0c.055.194.084.4.084.612v0a.75.75 0 0 1-.75.75H9a.75.75 0 0 1-.75-.75v0c0-.212.03-.418.084-.612m7.332 0c.646.049 1.288.11 1.927.184 1.1.128 1.907 1.077 1.907 2.185V19.5a2.25 2.25 0 0 1-2.25 2.25H6.75A2.25 2.25 0 0 1 4.5 19.5V6.257c0-1.108.806-2.057 1.907-2.185a48.208 48.208 0 0 1 1.927-.184"></path></svg><span>复制</span></button></div><div class="overflow-x-auto"><pre style="background:transparent;color:hsl(230, 8%, 24%);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.7;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1.25rem;margin:0;overflow:auto;border-radius:0.3em;font-size:0.875rem"><code class="language-sql" style="white-space:pre;background:transparent;color:hsl(230, 8%, 24%);font-family:ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, monospace;direction:ltr;text-align:left;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">1</span><span class="token" style="color:hsl(230, 4%, 64%);font-style:italic">-- 创建向量扩展</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">2</span><span></span><span class="token" style="color:hsl(301, 63%, 40%)">CREATE</span><span> EXTENSION </span><span class="token" style="color:hsl(301, 63%, 40%)">IF</span><span> </span><span class="token" style="color:hsl(221, 87%, 60%)">NOT</span><span> </span><span class="token" style="color:hsl(301, 63%, 40%)">EXISTS</span><span> vector</span><span class="token" style="color:hsl(230, 8%, 24%)">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">3</span>
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">4</span><span></span><span class="token" style="color:hsl(230, 4%, 64%);font-style:italic">-- 创建知识库表</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">5</span><span></span><span class="token" style="color:hsl(301, 63%, 40%)">CREATE</span><span> </span><span class="token" style="color:hsl(301, 63%, 40%)">TABLE</span><span> knowledge_base </span><span class="token" style="color:hsl(230, 8%, 24%)">(</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">6</span><span>    id </span><span class="token" style="color:hsl(301, 63%, 40%)">SERIAL</span><span> </span><span class="token" style="color:hsl(301, 63%, 40%)">PRIMARY</span><span> </span><span class="token" style="color:hsl(301, 63%, 40%)">KEY</span><span class="token" style="color:hsl(230, 8%, 24%)">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">7</span><span>    content </span><span class="token" style="color:hsl(301, 63%, 40%)">TEXT</span><span class="token" style="color:hsl(230, 8%, 24%)">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">8</span><span>    embedding VECTOR</span><span class="token" style="color:hsl(230, 8%, 24%)">(</span><span class="token" style="color:hsl(35, 99%, 36%)">768</span><span class="token" style="color:hsl(230, 8%, 24%)">)</span><span class="token" style="color:hsl(230, 8%, 24%)">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">9</span><span>    metadata JSONB</span><span class="token" style="color:hsl(230, 8%, 24%)">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">10</span><span>    created_at </span><span class="token" style="color:hsl(301, 63%, 40%)">TIMESTAMP</span><span> </span><span class="token" style="color:hsl(301, 63%, 40%)">DEFAULT</span><span> </span><span class="token" style="color:hsl(301, 63%, 40%)">CURRENT_TIMESTAMP</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">11</span><span></span><span class="token" style="color:hsl(230, 8%, 24%)">)</span><span class="token" style="color:hsl(230, 8%, 24%)">;</span></code></pre></div></div></pre>
<h3 id="2-文档处理流程" class="text-xl font-semibold mt-8 mb-3 text-slate-800 dark:text-slate-200 scroll-mt-24"><a href="#2-文档处理流程" class="text-indigo-600 dark:text-indigo-400 no-underline hover:underline">2. 文档处理流程</a></h3>
<pre><div class="relative group my-6 rounded-xl overflow-hidden border bg-slate-50 border-slate-200"><div class="flex items-center justify-between px-4 py-2 border-b bg-white border-slate-200"><span class="text-xs uppercase font-semibold tracking-wider text-slate-500">python</span><button class="flex items-center gap-1.5 px-3 py-1.5 text-xs font-medium rounded-lg transition-all text-slate-500 hover:text-slate-700 hover:bg-slate-200" aria-label="复制代码"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="w-3.5 h-3.5"><path stroke-linecap="round" stroke-linejoin="round" d="M15.666 3.888A2.25 2.25 0 0 0 13.5 2.25h-3c-1.03 0-1.9.693-2.166 1.638m7.332 0c.055.194.084.4.084.612v0a.75.75 0 0 1-.75.75H9a.75.75 0 0 1-.75-.75v0c0-.212.03-.418.084-.612m7.332 0c.646.049 1.288.11 1.927.184 1.1.128 1.907 1.077 1.907 2.185V19.5a2.25 2.25 0 0 1-2.25 2.25H6.75A2.25 2.25 0 0 1 4.5 19.5V6.257c0-1.108.806-2.057 1.907-2.185a48.208 48.208 0 0 1 1.927-.184"></path></svg><span>复制</span></button></div><div class="overflow-x-auto"><pre style="background:transparent;color:hsl(230, 8%, 24%);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.7;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1.25rem;margin:0;overflow:auto;border-radius:0.3em;font-size:0.875rem"><code class="language-python" style="white-space:pre;background:transparent;color:hsl(230, 8%, 24%);font-family:ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, monospace;direction:ltr;text-align:left;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">1</span><span class="token" style="color:hsl(301, 63%, 40%)">from</span><span> langchain</span><span class="token" style="color:hsl(230, 8%, 24%)">.</span><span>document_loaders </span><span class="token" style="color:hsl(301, 63%, 40%)">import</span><span> PyPDFLoader</span><span class="token" style="color:hsl(230, 8%, 24%)">,</span><span> DirectoryLoader
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">2</span><span></span><span class="token" style="color:hsl(301, 63%, 40%)">from</span><span> langchain</span><span class="token" style="color:hsl(230, 8%, 24%)">.</span><span>text_splitter </span><span class="token" style="color:hsl(301, 63%, 40%)">import</span><span> RecursiveCharacterTextSplitter
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">3</span><span></span><span class="token" style="color:hsl(301, 63%, 40%)">from</span><span> langchain</span><span class="token" style="color:hsl(230, 8%, 24%)">.</span><span>embeddings </span><span class="token" style="color:hsl(301, 63%, 40%)">import</span><span> HuggingFaceEmbeddings
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">4</span><span></span><span class="token" style="color:hsl(301, 63%, 40%)">from</span><span> langchain</span><span class="token" style="color:hsl(230, 8%, 24%)">.</span><span>vectorstores </span><span class="token" style="color:hsl(301, 63%, 40%)">import</span><span> Milvus
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">5</span>
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">6</span><span></span><span class="token" style="color:hsl(230, 4%, 64%);font-style:italic"># 加载文档</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">7</span><span>loader </span><span class="token" style="color:hsl(221, 87%, 60%)">=</span><span> DirectoryLoader</span><span class="token" style="color:hsl(230, 8%, 24%)">(</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">8</span><span>    </span><span class="token" style="color:hsl(119, 34%, 47%)">&quot;./documents&quot;</span><span class="token" style="color:hsl(230, 8%, 24%)">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">9</span><span>    glob</span><span class="token" style="color:hsl(221, 87%, 60%)">=</span><span class="token" style="color:hsl(119, 34%, 47%)">&quot;**/*.pdf&quot;</span><span class="token" style="color:hsl(230, 8%, 24%)">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">10</span><span>    loader_cls</span><span class="token" style="color:hsl(221, 87%, 60%)">=</span><span>PyPDFLoader
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">11</span><span></span><span class="token" style="color:hsl(230, 8%, 24%)">)</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">12</span><span>documents </span><span class="token" style="color:hsl(221, 87%, 60%)">=</span><span> loader</span><span class="token" style="color:hsl(230, 8%, 24%)">.</span><span>load</span><span class="token" style="color:hsl(230, 8%, 24%)">(</span><span class="token" style="color:hsl(230, 8%, 24%)">)</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">13</span>
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">14</span><span></span><span class="token" style="color:hsl(230, 4%, 64%);font-style:italic"># 文档分块</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">15</span><span>text_splitter </span><span class="token" style="color:hsl(221, 87%, 60%)">=</span><span> RecursiveCharacterTextSplitter</span><span class="token" style="color:hsl(230, 8%, 24%)">(</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">16</span><span>    chunk_size</span><span class="token" style="color:hsl(221, 87%, 60%)">=</span><span class="token" style="color:hsl(35, 99%, 36%)">500</span><span class="token" style="color:hsl(230, 8%, 24%)">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">17</span><span>    chunk_overlap</span><span class="token" style="color:hsl(221, 87%, 60%)">=</span><span class="token" style="color:hsl(35, 99%, 36%)">50</span><span class="token" style="color:hsl(230, 8%, 24%)">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">18</span><span>    separators</span><span class="token" style="color:hsl(221, 87%, 60%)">=</span><span class="token" style="color:hsl(230, 8%, 24%)">[</span><span class="token" style="color:hsl(119, 34%, 47%)">&quot;\n\n&quot;</span><span class="token" style="color:hsl(230, 8%, 24%)">,</span><span> </span><span class="token" style="color:hsl(119, 34%, 47%)">&quot;\n&quot;</span><span class="token" style="color:hsl(230, 8%, 24%)">,</span><span> </span><span class="token" style="color:hsl(119, 34%, 47%)">&quot;。&quot;</span><span class="token" style="color:hsl(230, 8%, 24%)">,</span><span> </span><span class="token" style="color:hsl(119, 34%, 47%)">&quot;；&quot;</span><span class="token" style="color:hsl(230, 8%, 24%)">,</span><span> </span><span class="token" style="color:hsl(119, 34%, 47%)">&quot; &quot;</span><span class="token" style="color:hsl(230, 8%, 24%)">]</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">19</span><span></span><span class="token" style="color:hsl(230, 8%, 24%)">)</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">20</span><span>chunks </span><span class="token" style="color:hsl(221, 87%, 60%)">=</span><span> text_splitter</span><span class="token" style="color:hsl(230, 8%, 24%)">.</span><span>split_documents</span><span class="token" style="color:hsl(230, 8%, 24%)">(</span><span>documents</span><span class="token" style="color:hsl(230, 8%, 24%)">)</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">21</span>
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">22</span><span></span><span class="token" style="color:hsl(230, 4%, 64%);font-style:italic"># 创建 Embedding</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">23</span><span>embeddings </span><span class="token" style="color:hsl(221, 87%, 60%)">=</span><span> HuggingFaceEmbeddings</span><span class="token" style="color:hsl(230, 8%, 24%)">(</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">24</span><span>    model_name</span><span class="token" style="color:hsl(221, 87%, 60%)">=</span><span class="token" style="color:hsl(119, 34%, 47%)">&quot;BAAI/bge-large-zh-v1.5&quot;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">25</span><span></span><span class="token" style="color:hsl(230, 8%, 24%)">)</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">26</span>
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">27</span><span></span><span class="token" style="color:hsl(230, 4%, 64%);font-style:italic"># 存入向量库</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">28</span><span>vector_store </span><span class="token" style="color:hsl(221, 87%, 60%)">=</span><span> Milvus</span><span class="token" style="color:hsl(230, 8%, 24%)">.</span><span>from_documents</span><span class="token" style="color:hsl(230, 8%, 24%)">(</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">29</span><span>    documents</span><span class="token" style="color:hsl(221, 87%, 60%)">=</span><span>chunks</span><span class="token" style="color:hsl(230, 8%, 24%)">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">30</span><span>    embedding</span><span class="token" style="color:hsl(221, 87%, 60%)">=</span><span>embeddings</span><span class="token" style="color:hsl(230, 8%, 24%)">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">31</span><span>    connection_args</span><span class="token" style="color:hsl(221, 87%, 60%)">=</span><span class="token" style="color:hsl(230, 8%, 24%)">{</span><span class="token" style="color:hsl(119, 34%, 47%)">&quot;host&quot;</span><span class="token" style="color:hsl(230, 8%, 24%)">:</span><span> </span><span class="token" style="color:hsl(119, 34%, 47%)">&quot;localhost&quot;</span><span class="token" style="color:hsl(230, 8%, 24%)">,</span><span> </span><span class="token" style="color:hsl(119, 34%, 47%)">&quot;port&quot;</span><span class="token" style="color:hsl(230, 8%, 24%)">:</span><span> </span><span class="token" style="color:hsl(119, 34%, 47%)">&quot;19530&quot;</span><span class="token" style="color:hsl(230, 8%, 24%)">}</span><span class="token" style="color:hsl(230, 8%, 24%)">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">32</span><span>    collection_name</span><span class="token" style="color:hsl(221, 87%, 60%)">=</span><span class="token" style="color:hsl(119, 34%, 47%)">&quot;company_knowledge&quot;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">33</span><span></span><span class="token" style="color:hsl(230, 8%, 24%)">)</span></code></pre></div></div></pre>
<h3 id="3-检索与问答" class="text-xl font-semibold mt-8 mb-3 text-slate-800 dark:text-slate-200 scroll-mt-24"><a href="#3-检索与问答" class="text-indigo-600 dark:text-indigo-400 no-underline hover:underline">3. 检索与问答</a></h3>
<pre><div class="relative group my-6 rounded-xl overflow-hidden border bg-slate-50 border-slate-200"><div class="flex items-center justify-between px-4 py-2 border-b bg-white border-slate-200"><span class="text-xs uppercase font-semibold tracking-wider text-slate-500">python</span><button class="flex items-center gap-1.5 px-3 py-1.5 text-xs font-medium rounded-lg transition-all text-slate-500 hover:text-slate-700 hover:bg-slate-200" aria-label="复制代码"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="w-3.5 h-3.5"><path stroke-linecap="round" stroke-linejoin="round" d="M15.666 3.888A2.25 2.25 0 0 0 13.5 2.25h-3c-1.03 0-1.9.693-2.166 1.638m7.332 0c.055.194.084.4.084.612v0a.75.75 0 0 1-.75.75H9a.75.75 0 0 1-.75-.75v0c0-.212.03-.418.084-.612m7.332 0c.646.049 1.288.11 1.927.184 1.1.128 1.907 1.077 1.907 2.185V19.5a2.25 2.25 0 0 1-2.25 2.25H6.75A2.25 2.25 0 0 1 4.5 19.5V6.257c0-1.108.806-2.057 1.907-2.185a48.208 48.208 0 0 1 1.927-.184"></path></svg><span>复制</span></button></div><div class="overflow-x-auto"><pre style="background:transparent;color:hsl(230, 8%, 24%);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.7;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1.25rem;margin:0;overflow:auto;border-radius:0.3em;font-size:0.875rem"><code class="language-python" style="white-space:pre;background:transparent;color:hsl(230, 8%, 24%);font-family:ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, monospace;direction:ltr;text-align:left;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">1</span><span class="token" style="color:hsl(301, 63%, 40%)">from</span><span> langchain</span><span class="token" style="color:hsl(230, 8%, 24%)">.</span><span>chains </span><span class="token" style="color:hsl(301, 63%, 40%)">import</span><span> RetrievalQA
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">2</span><span></span><span class="token" style="color:hsl(301, 63%, 40%)">from</span><span> langchain</span><span class="token" style="color:hsl(230, 8%, 24%)">.</span><span>llms </span><span class="token" style="color:hsl(301, 63%, 40%)">import</span><span> OpenAI
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">3</span>
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">4</span><span></span><span class="token" style="color:hsl(230, 4%, 64%);font-style:italic"># 创建检索器</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">5</span><span>retriever </span><span class="token" style="color:hsl(221, 87%, 60%)">=</span><span> vector_store</span><span class="token" style="color:hsl(230, 8%, 24%)">.</span><span>as_retriever</span><span class="token" style="color:hsl(230, 8%, 24%)">(</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">6</span><span>    search_type</span><span class="token" style="color:hsl(221, 87%, 60%)">=</span><span class="token" style="color:hsl(119, 34%, 47%)">&quot;similarity&quot;</span><span class="token" style="color:hsl(230, 8%, 24%)">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">7</span><span>    search_kwargs</span><span class="token" style="color:hsl(221, 87%, 60%)">=</span><span class="token" style="color:hsl(230, 8%, 24%)">{</span><span class="token" style="color:hsl(119, 34%, 47%)">&quot;k&quot;</span><span class="token" style="color:hsl(230, 8%, 24%)">:</span><span> </span><span class="token" style="color:hsl(35, 99%, 36%)">5</span><span class="token" style="color:hsl(230, 8%, 24%)">}</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">8</span><span></span><span class="token" style="color:hsl(230, 8%, 24%)">)</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">9</span>
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">10</span><span></span><span class="token" style="color:hsl(230, 4%, 64%);font-style:italic"># 构建 RAG 链</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">11</span><span>qa_chain </span><span class="token" style="color:hsl(221, 87%, 60%)">=</span><span> RetrievalQA</span><span class="token" style="color:hsl(230, 8%, 24%)">.</span><span>from_chain_type</span><span class="token" style="color:hsl(230, 8%, 24%)">(</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">12</span><span>    llm</span><span class="token" style="color:hsl(221, 87%, 60%)">=</span><span>OpenAI</span><span class="token" style="color:hsl(230, 8%, 24%)">(</span><span class="token" style="color:hsl(230, 8%, 24%)">)</span><span class="token" style="color:hsl(230, 8%, 24%)">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">13</span><span>    chain_type</span><span class="token" style="color:hsl(221, 87%, 60%)">=</span><span class="token" style="color:hsl(119, 34%, 47%)">&quot;stuff&quot;</span><span class="token" style="color:hsl(230, 8%, 24%)">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">14</span><span>    retriever</span><span class="token" style="color:hsl(221, 87%, 60%)">=</span><span>retriever</span><span class="token" style="color:hsl(230, 8%, 24%)">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">15</span><span>    return_source_documents</span><span class="token" style="color:hsl(221, 87%, 60%)">=</span><span class="token" style="color:hsl(35, 99%, 36%)">True</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">16</span><span></span><span class="token" style="color:hsl(230, 8%, 24%)">)</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">17</span>
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">18</span><span></span><span class="token" style="color:hsl(230, 4%, 64%);font-style:italic"># 提问</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">19</span><span>result </span><span class="token" style="color:hsl(221, 87%, 60%)">=</span><span> qa_chain</span><span class="token" style="color:hsl(230, 8%, 24%)">(</span><span class="token" style="color:hsl(230, 8%, 24%)">{</span><span class="token" style="color:hsl(119, 34%, 47%)">&quot;query&quot;</span><span class="token" style="color:hsl(230, 8%, 24%)">:</span><span> </span><span class="token" style="color:hsl(119, 34%, 47%)">&quot;公司的年假政策是什么？&quot;</span><span class="token" style="color:hsl(230, 8%, 24%)">}</span><span class="token" style="color:hsl(230, 8%, 24%)">)</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">20</span><span></span><span class="token" style="color:hsl(301, 63%, 40%)">print</span><span class="token" style="color:hsl(230, 8%, 24%)">(</span><span>result</span><span class="token" style="color:hsl(230, 8%, 24%)">[</span><span class="token" style="color:hsl(119, 34%, 47%)">&quot;result&quot;</span><span class="token" style="color:hsl(230, 8%, 24%)">]</span><span class="token" style="color:hsl(230, 8%, 24%)">)</span></code></pre></div></div></pre>
<h2 id="高级配置" class="text-2xl font-semibold mt-12 mb-4 text-slate-900 dark:text-white border-b border-slate-200 dark:border-slate-700 pb-3 scroll-mt-24"><a href="#高级配置" class="text-indigo-600 dark:text-indigo-400 no-underline hover:underline">高级配置</a></h2>
<h3 id="混合检索策略" class="text-xl font-semibold mt-8 mb-3 text-slate-800 dark:text-slate-200 scroll-mt-24"><a href="#混合检索策略" class="text-indigo-600 dark:text-indigo-400 no-underline hover:underline">混合检索策略</a></h3>
<p class="text-slate-600 dark:text-slate-300 leading-relaxed mb-4">结合向量检索与关键词检索，提升准确性：</p>
<pre><div class="relative group my-6 rounded-xl overflow-hidden border bg-slate-50 border-slate-200"><div class="flex items-center justify-between px-4 py-2 border-b bg-white border-slate-200"><span class="text-xs uppercase font-semibold tracking-wider text-slate-500">python</span><button class="flex items-center gap-1.5 px-3 py-1.5 text-xs font-medium rounded-lg transition-all text-slate-500 hover:text-slate-700 hover:bg-slate-200" aria-label="复制代码"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="w-3.5 h-3.5"><path stroke-linecap="round" stroke-linejoin="round" d="M15.666 3.888A2.25 2.25 0 0 0 13.5 2.25h-3c-1.03 0-1.9.693-2.166 1.638m7.332 0c.055.194.084.4.084.612v0a.75.75 0 0 1-.75.75H9a.75.75 0 0 1-.75-.75v0c0-.212.03-.418.084-.612m7.332 0c.646.049 1.288.11 1.927.184 1.1.128 1.907 1.077 1.907 2.185V19.5a2.25 2.25 0 0 1-2.25 2.25H6.75A2.25 2.25 0 0 1 4.5 19.5V6.257c0-1.108.806-2.057 1.907-2.185a48.208 48.208 0 0 1 1.927-.184"></path></svg><span>复制</span></button></div><div class="overflow-x-auto"><pre style="background:transparent;color:hsl(230, 8%, 24%);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.7;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1.25rem;margin:0;overflow:auto;border-radius:0.3em;font-size:0.875rem"><code class="language-python" style="white-space:pre;background:transparent;color:hsl(230, 8%, 24%);font-family:ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, monospace;direction:ltr;text-align:left;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">1</span><span class="token" style="color:hsl(301, 63%, 40%)">from</span><span> langchain</span><span class="token" style="color:hsl(230, 8%, 24%)">.</span><span>retrievers </span><span class="token" style="color:hsl(301, 63%, 40%)">import</span><span> BM25Retriever</span><span class="token" style="color:hsl(230, 8%, 24%)">,</span><span> EnsembleRetriever
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">2</span>
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">3</span><span></span><span class="token" style="color:hsl(230, 4%, 64%);font-style:italic"># BM25 关键词检索</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">4</span><span>bm25_retriever </span><span class="token" style="color:hsl(221, 87%, 60%)">=</span><span> BM25Retriever</span><span class="token" style="color:hsl(230, 8%, 24%)">.</span><span>from_documents</span><span class="token" style="color:hsl(230, 8%, 24%)">(</span><span>chunks</span><span class="token" style="color:hsl(230, 8%, 24%)">)</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">5</span><span>bm25_retriever</span><span class="token" style="color:hsl(230, 8%, 24%)">.</span><span>k </span><span class="token" style="color:hsl(221, 87%, 60%)">=</span><span> </span><span class="token" style="color:hsl(35, 99%, 36%)">5</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">6</span>
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">7</span><span></span><span class="token" style="color:hsl(230, 4%, 64%);font-style:italic"># 向量检索</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">8</span><span>vector_retriever </span><span class="token" style="color:hsl(221, 87%, 60%)">=</span><span> vector_store</span><span class="token" style="color:hsl(230, 8%, 24%)">.</span><span>as_retriever</span><span class="token" style="color:hsl(230, 8%, 24%)">(</span><span>search_kwargs</span><span class="token" style="color:hsl(221, 87%, 60%)">=</span><span class="token" style="color:hsl(230, 8%, 24%)">{</span><span class="token" style="color:hsl(119, 34%, 47%)">&quot;k&quot;</span><span class="token" style="color:hsl(230, 8%, 24%)">:</span><span> </span><span class="token" style="color:hsl(35, 99%, 36%)">5</span><span class="token" style="color:hsl(230, 8%, 24%)">}</span><span class="token" style="color:hsl(230, 8%, 24%)">)</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">9</span>
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">10</span><span></span><span class="token" style="color:hsl(230, 4%, 64%);font-style:italic"># 融合检索</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">11</span><span>ensemble_retriever </span><span class="token" style="color:hsl(221, 87%, 60%)">=</span><span> EnsembleRetriever</span><span class="token" style="color:hsl(230, 8%, 24%)">(</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">12</span><span>    retrievers</span><span class="token" style="color:hsl(221, 87%, 60%)">=</span><span class="token" style="color:hsl(230, 8%, 24%)">[</span><span>bm25_retriever</span><span class="token" style="color:hsl(230, 8%, 24%)">,</span><span> vector_retriever</span><span class="token" style="color:hsl(230, 8%, 24%)">]</span><span class="token" style="color:hsl(230, 8%, 24%)">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">13</span><span>    weights</span><span class="token" style="color:hsl(221, 87%, 60%)">=</span><span class="token" style="color:hsl(230, 8%, 24%)">[</span><span class="token" style="color:hsl(35, 99%, 36%)">0.3</span><span class="token" style="color:hsl(230, 8%, 24%)">,</span><span> </span><span class="token" style="color:hsl(35, 99%, 36%)">0.7</span><span class="token" style="color:hsl(230, 8%, 24%)">]</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">14</span><span></span><span class="token" style="color:hsl(230, 8%, 24%)">)</span></code></pre></div></div></pre>
<h3 id="重排序优化" class="text-xl font-semibold mt-8 mb-3 text-slate-800 dark:text-slate-200 scroll-mt-24"><a href="#重排序优化" class="text-indigo-600 dark:text-indigo-400 no-underline hover:underline">重排序优化</a></h3>
<p class="text-slate-600 dark:text-slate-300 leading-relaxed mb-4">使用重排序模型提升检索质量：</p>
<pre><div class="relative group my-6 rounded-xl overflow-hidden border bg-slate-50 border-slate-200"><div class="flex items-center justify-between px-4 py-2 border-b bg-white border-slate-200"><span class="text-xs uppercase font-semibold tracking-wider text-slate-500">python</span><button class="flex items-center gap-1.5 px-3 py-1.5 text-xs font-medium rounded-lg transition-all text-slate-500 hover:text-slate-700 hover:bg-slate-200" aria-label="复制代码"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="w-3.5 h-3.5"><path stroke-linecap="round" stroke-linejoin="round" d="M15.666 3.888A2.25 2.25 0 0 0 13.5 2.25h-3c-1.03 0-1.9.693-2.166 1.638m7.332 0c.055.194.084.4.084.612v0a.75.75 0 0 1-.75.75H9a.75.75 0 0 1-.75-.75v0c0-.212.03-.418.084-.612m7.332 0c.646.049 1.288.11 1.927.184 1.1.128 1.907 1.077 1.907 2.185V19.5a2.25 2.25 0 0 1-2.25 2.25H6.75A2.25 2.25 0 0 1 4.5 19.5V6.257c0-1.108.806-2.057 1.907-2.185a48.208 48.208 0 0 1 1.927-.184"></path></svg><span>复制</span></button></div><div class="overflow-x-auto"><pre style="background:transparent;color:hsl(230, 8%, 24%);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.7;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1.25rem;margin:0;overflow:auto;border-radius:0.3em;font-size:0.875rem"><code class="language-python" style="white-space:pre;background:transparent;color:hsl(230, 8%, 24%);font-family:ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, monospace;direction:ltr;text-align:left;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">1</span><span class="token" style="color:hsl(301, 63%, 40%)">from</span><span> langchain</span><span class="token" style="color:hsl(230, 8%, 24%)">.</span><span>retrievers </span><span class="token" style="color:hsl(301, 63%, 40%)">import</span><span> ContextualCompressionRetriever
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">2</span><span></span><span class="token" style="color:hsl(301, 63%, 40%)">from</span><span> langchain</span><span class="token" style="color:hsl(230, 8%, 24%)">.</span><span>retrievers</span><span class="token" style="color:hsl(230, 8%, 24%)">.</span><span>document_compressors </span><span class="token" style="color:hsl(301, 63%, 40%)">import</span><span> CrossEncoderReranker
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">3</span>
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">4</span><span></span><span class="token" style="color:hsl(230, 4%, 64%);font-style:italic"># 重排序模型</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">5</span><span>reranker </span><span class="token" style="color:hsl(221, 87%, 60%)">=</span><span> CrossEncoderReranker</span><span class="token" style="color:hsl(230, 8%, 24%)">(</span><span>model</span><span class="token" style="color:hsl(221, 87%, 60%)">=</span><span class="token" style="color:hsl(119, 34%, 47%)">&quot;BAAI/bge-reranker-large&quot;</span><span class="token" style="color:hsl(230, 8%, 24%)">)</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">6</span>
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">7</span><span></span><span class="token" style="color:hsl(230, 4%, 64%);font-style:italic"># 压缩检索器</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">8</span><span>compression_retriever </span><span class="token" style="color:hsl(221, 87%, 60%)">=</span><span> ContextualCompressionRetriever</span><span class="token" style="color:hsl(230, 8%, 24%)">(</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">9</span><span>    base_compressor</span><span class="token" style="color:hsl(221, 87%, 60%)">=</span><span>reranker</span><span class="token" style="color:hsl(230, 8%, 24%)">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">10</span><span>    base_retriever</span><span class="token" style="color:hsl(221, 87%, 60%)">=</span><span>vector_retriever
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">11</span><span></span><span class="token" style="color:hsl(230, 8%, 24%)">)</span></code></pre></div></div></pre>
<h3 id="多租户隔离" class="text-xl font-semibold mt-8 mb-3 text-slate-800 dark:text-slate-200 scroll-mt-24"><a href="#多租户隔离" class="text-indigo-600 dark:text-indigo-400 no-underline hover:underline">多租户隔离</a></h3>
<p class="text-slate-600 dark:text-slate-300 leading-relaxed mb-4">企业场景下的数据隔离方案：</p>
<pre><div class="relative group my-6 rounded-xl overflow-hidden border bg-slate-50 border-slate-200"><div class="flex items-center justify-between px-4 py-2 border-b bg-white border-slate-200"><span class="text-xs uppercase font-semibold tracking-wider text-slate-500">python</span><button class="flex items-center gap-1.5 px-3 py-1.5 text-xs font-medium rounded-lg transition-all text-slate-500 hover:text-slate-700 hover:bg-slate-200" aria-label="复制代码"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="w-3.5 h-3.5"><path stroke-linecap="round" stroke-linejoin="round" d="M15.666 3.888A2.25 2.25 0 0 0 13.5 2.25h-3c-1.03 0-1.9.693-2.166 1.638m7.332 0c.055.194.084.4.084.612v0a.75.75 0 0 1-.75.75H9a.75.75 0 0 1-.75-.75v0c0-.212.03-.418.084-.612m7.332 0c.646.049 1.288.11 1.927.184 1.1.128 1.907 1.077 1.907 2.185V19.5a2.25 2.25 0 0 1-2.25 2.25H6.75A2.25 2.25 0 0 1 4.5 19.5V6.257c0-1.108.806-2.057 1.907-2.185a48.208 48.208 0 0 1 1.927-.184"></path></svg><span>复制</span></button></div><div class="overflow-x-auto"><pre style="background:transparent;color:hsl(230, 8%, 24%);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.7;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1.25rem;margin:0;overflow:auto;border-radius:0.3em;font-size:0.875rem"><code class="language-python" style="white-space:pre;background:transparent;color:hsl(230, 8%, 24%);font-family:ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, monospace;direction:ltr;text-align:left;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">1</span><span class="token" style="color:hsl(230, 4%, 64%);font-style:italic"># 为每个租户创建独立 Collection</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">2</span><span></span><span class="token" style="color:hsl(301, 63%, 40%)">from</span><span> pymilvus </span><span class="token" style="color:hsl(301, 63%, 40%)">import</span><span> Collection</span><span class="token" style="color:hsl(230, 8%, 24%)">,</span><span> FieldSchema</span><span class="token" style="color:hsl(230, 8%, 24%)">,</span><span> CollectionSchema</span><span class="token" style="color:hsl(230, 8%, 24%)">,</span><span> DataType
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">3</span>
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">4</span><span></span><span class="token" style="color:hsl(301, 63%, 40%)">def</span><span> </span><span class="token" style="color:hsl(221, 87%, 60%)">create_tenant_collection</span><span class="token" style="color:hsl(230, 8%, 24%)">(</span><span>tenant_id</span><span class="token" style="color:hsl(230, 8%, 24%)">)</span><span class="token" style="color:hsl(230, 8%, 24%)">:</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">5</span><span>    fields </span><span class="token" style="color:hsl(221, 87%, 60%)">=</span><span> </span><span class="token" style="color:hsl(230, 8%, 24%)">[</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">6</span><span>        FieldSchema</span><span class="token" style="color:hsl(230, 8%, 24%)">(</span><span>name</span><span class="token" style="color:hsl(221, 87%, 60%)">=</span><span class="token" style="color:hsl(119, 34%, 47%)">&quot;id&quot;</span><span class="token" style="color:hsl(230, 8%, 24%)">,</span><span> dtype</span><span class="token" style="color:hsl(221, 87%, 60%)">=</span><span>DataType</span><span class="token" style="color:hsl(230, 8%, 24%)">.</span><span>INT64</span><span class="token" style="color:hsl(230, 8%, 24%)">,</span><span> is_primary</span><span class="token" style="color:hsl(221, 87%, 60%)">=</span><span class="token" style="color:hsl(35, 99%, 36%)">True</span><span class="token" style="color:hsl(230, 8%, 24%)">)</span><span class="token" style="color:hsl(230, 8%, 24%)">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">7</span><span>        FieldSchema</span><span class="token" style="color:hsl(230, 8%, 24%)">(</span><span>name</span><span class="token" style="color:hsl(221, 87%, 60%)">=</span><span class="token" style="color:hsl(119, 34%, 47%)">&quot;content&quot;</span><span class="token" style="color:hsl(230, 8%, 24%)">,</span><span> dtype</span><span class="token" style="color:hsl(221, 87%, 60%)">=</span><span>DataType</span><span class="token" style="color:hsl(230, 8%, 24%)">.</span><span>VARCHAR</span><span class="token" style="color:hsl(230, 8%, 24%)">,</span><span> max_length</span><span class="token" style="color:hsl(221, 87%, 60%)">=</span><span class="token" style="color:hsl(35, 99%, 36%)">65535</span><span class="token" style="color:hsl(230, 8%, 24%)">)</span><span class="token" style="color:hsl(230, 8%, 24%)">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">8</span><span>        FieldSchema</span><span class="token" style="color:hsl(230, 8%, 24%)">(</span><span>name</span><span class="token" style="color:hsl(221, 87%, 60%)">=</span><span class="token" style="color:hsl(119, 34%, 47%)">&quot;embedding&quot;</span><span class="token" style="color:hsl(230, 8%, 24%)">,</span><span> dtype</span><span class="token" style="color:hsl(221, 87%, 60%)">=</span><span>DataType</span><span class="token" style="color:hsl(230, 8%, 24%)">.</span><span>FLOAT_VECTOR</span><span class="token" style="color:hsl(230, 8%, 24%)">,</span><span> dim</span><span class="token" style="color:hsl(221, 87%, 60%)">=</span><span class="token" style="color:hsl(35, 99%, 36%)">768</span><span class="token" style="color:hsl(230, 8%, 24%)">)</span><span class="token" style="color:hsl(230, 8%, 24%)">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">9</span><span>        FieldSchema</span><span class="token" style="color:hsl(230, 8%, 24%)">(</span><span>name</span><span class="token" style="color:hsl(221, 87%, 60%)">=</span><span class="token" style="color:hsl(119, 34%, 47%)">&quot;metadata&quot;</span><span class="token" style="color:hsl(230, 8%, 24%)">,</span><span> dtype</span><span class="token" style="color:hsl(221, 87%, 60%)">=</span><span>DataType</span><span class="token" style="color:hsl(230, 8%, 24%)">.</span><span>JSON</span><span class="token" style="color:hsl(230, 8%, 24%)">)</span><span class="token" style="color:hsl(230, 8%, 24%)">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">10</span><span>        FieldSchema</span><span class="token" style="color:hsl(230, 8%, 24%)">(</span><span>name</span><span class="token" style="color:hsl(221, 87%, 60%)">=</span><span class="token" style="color:hsl(119, 34%, 47%)">&quot;tenant_id&quot;</span><span class="token" style="color:hsl(230, 8%, 24%)">,</span><span> dtype</span><span class="token" style="color:hsl(221, 87%, 60%)">=</span><span>DataType</span><span class="token" style="color:hsl(230, 8%, 24%)">.</span><span>VARCHAR</span><span class="token" style="color:hsl(230, 8%, 24%)">,</span><span> max_length</span><span class="token" style="color:hsl(221, 87%, 60%)">=</span><span class="token" style="color:hsl(35, 99%, 36%)">64</span><span class="token" style="color:hsl(230, 8%, 24%)">)</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">11</span><span>    </span><span class="token" style="color:hsl(230, 8%, 24%)">]</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">12</span>    
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">13</span><span>    schema </span><span class="token" style="color:hsl(221, 87%, 60%)">=</span><span> CollectionSchema</span><span class="token" style="color:hsl(230, 8%, 24%)">(</span><span>fields</span><span class="token" style="color:hsl(230, 8%, 24%)">)</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">14</span><span>    collection </span><span class="token" style="color:hsl(221, 87%, 60%)">=</span><span> Collection</span><span class="token" style="color:hsl(230, 8%, 24%)">(</span><span class="token string-interpolation" style="color:hsl(119, 34%, 47%)">f&quot;knowledge_</span><span class="token string-interpolation interpolation" style="color:hsl(230, 8%, 24%)">{</span><span class="token string-interpolation interpolation">tenant_id</span><span class="token string-interpolation interpolation" style="color:hsl(230, 8%, 24%)">}</span><span class="token string-interpolation" style="color:hsl(119, 34%, 47%)">&quot;</span><span class="token" style="color:hsl(230, 8%, 24%)">,</span><span> schema</span><span class="token" style="color:hsl(230, 8%, 24%)">)</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">15</span>    
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">16</span><span>    </span><span class="token" style="color:hsl(230, 4%, 64%);font-style:italic"># 创建索引</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">17</span><span>    index_params </span><span class="token" style="color:hsl(221, 87%, 60%)">=</span><span> </span><span class="token" style="color:hsl(230, 8%, 24%)">{</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">18</span><span>        </span><span class="token" style="color:hsl(119, 34%, 47%)">&quot;metric_type&quot;</span><span class="token" style="color:hsl(230, 8%, 24%)">:</span><span> </span><span class="token" style="color:hsl(119, 34%, 47%)">&quot;COSINE&quot;</span><span class="token" style="color:hsl(230, 8%, 24%)">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">19</span><span>        </span><span class="token" style="color:hsl(119, 34%, 47%)">&quot;index_type&quot;</span><span class="token" style="color:hsl(230, 8%, 24%)">:</span><span> </span><span class="token" style="color:hsl(119, 34%, 47%)">&quot;IVF_FLAT&quot;</span><span class="token" style="color:hsl(230, 8%, 24%)">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">20</span><span>        </span><span class="token" style="color:hsl(119, 34%, 47%)">&quot;params&quot;</span><span class="token" style="color:hsl(230, 8%, 24%)">:</span><span> </span><span class="token" style="color:hsl(230, 8%, 24%)">{</span><span class="token" style="color:hsl(119, 34%, 47%)">&quot;nlist&quot;</span><span class="token" style="color:hsl(230, 8%, 24%)">:</span><span> </span><span class="token" style="color:hsl(35, 99%, 36%)">1024</span><span class="token" style="color:hsl(230, 8%, 24%)">}</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">21</span><span>    </span><span class="token" style="color:hsl(230, 8%, 24%)">}</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">22</span><span>    collection</span><span class="token" style="color:hsl(230, 8%, 24%)">.</span><span>create_index</span><span class="token" style="color:hsl(230, 8%, 24%)">(</span><span class="token" style="color:hsl(119, 34%, 47%)">&quot;embedding&quot;</span><span class="token" style="color:hsl(230, 8%, 24%)">,</span><span> index_params</span><span class="token" style="color:hsl(230, 8%, 24%)">)</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">23</span><span>    </span><span class="token" style="color:hsl(301, 63%, 40%)">return</span><span> collection</span></code></pre></div></div></pre>
<h2 id="性能优化" class="text-2xl font-semibold mt-12 mb-4 text-slate-900 dark:text-white border-b border-slate-200 dark:border-slate-700 pb-3 scroll-mt-24"><a href="#性能优化" class="text-indigo-600 dark:text-indigo-400 no-underline hover:underline">性能优化</a></h2>
<h3 id="1-embedding-模型选择" class="text-xl font-semibold mt-8 mb-3 text-slate-800 dark:text-slate-200 scroll-mt-24"><a href="#1-embedding-模型选择" class="text-indigo-600 dark:text-indigo-400 no-underline hover:underline">1. Embedding 模型选择</a></h3>
<div class="overflow-x-auto my-6"><table class="w-full border-collapse"><thead class="bg-slate-50 dark:bg-slate-800"><tr><th class="border border-slate-200 dark:border-slate-700 px-4 py-2 text-left font-semibold">模型</th><th class="border border-slate-200 dark:border-slate-700 px-4 py-2 text-left font-semibold">维度</th><th class="border border-slate-200 dark:border-slate-700 px-4 py-2 text-left font-semibold">语言</th><th class="border border-slate-200 dark:border-slate-700 px-4 py-2 text-left font-semibold">适用场景</th></tr></thead><tbody><tr><td class="border border-slate-200 dark:border-slate-700 px-4 py-2">BAAI/bge-large-zh</td><td class="border border-slate-200 dark:border-slate-700 px-4 py-2">1024</td><td class="border border-slate-200 dark:border-slate-700 px-4 py-2">中文</td><td class="border border-slate-200 dark:border-slate-700 px-4 py-2">通用中文场景</td></tr><tr><td class="border border-slate-200 dark:border-slate-700 px-4 py-2">BAAI/bge-m3</td><td class="border border-slate-200 dark:border-slate-700 px-4 py-2">1024</td><td class="border border-slate-200 dark:border-slate-700 px-4 py-2">多语言</td><td class="border border-slate-200 dark:border-slate-700 px-4 py-2">多语言混合</td></tr><tr><td class="border border-slate-200 dark:border-slate-700 px-4 py-2">text-embedding-3</td><td class="border border-slate-200 dark:border-slate-700 px-4 py-2">1536</td><td class="border border-slate-200 dark:border-slate-700 px-4 py-2">多语言</td><td class="border border-slate-200 dark:border-slate-700 px-4 py-2">OpenAI 生态</td></tr><tr><td class="border border-slate-200 dark:border-slate-700 px-4 py-2">m3e-base</td><td class="border border-slate-200 dark:border-slate-700 px-4 py-2">768</td><td class="border border-slate-200 dark:border-slate-700 px-4 py-2">中文</td><td class="border border-slate-200 dark:border-slate-700 px-4 py-2">轻量级应用</td></tr></tbody></table></div>
<h3 id="2-分块策略优化" class="text-xl font-semibold mt-8 mb-3 text-slate-800 dark:text-slate-200 scroll-mt-24"><a href="#2-分块策略优化" class="text-indigo-600 dark:text-indigo-400 no-underline hover:underline">2. 分块策略优化</a></h3>
<pre><div class="relative group my-6 rounded-xl overflow-hidden border bg-slate-50 border-slate-200"><div class="flex items-center justify-between px-4 py-2 border-b bg-white border-slate-200"><span class="text-xs uppercase font-semibold tracking-wider text-slate-500">python</span><button class="flex items-center gap-1.5 px-3 py-1.5 text-xs font-medium rounded-lg transition-all text-slate-500 hover:text-slate-700 hover:bg-slate-200" aria-label="复制代码"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="w-3.5 h-3.5"><path stroke-linecap="round" stroke-linejoin="round" d="M15.666 3.888A2.25 2.25 0 0 0 13.5 2.25h-3c-1.03 0-1.9.693-2.166 1.638m7.332 0c.055.194.084.4.084.612v0a.75.75 0 0 1-.75.75H9a.75.75 0 0 1-.75-.75v0c0-.212.03-.418.084-.612m7.332 0c.646.049 1.288.11 1.927.184 1.1.128 1.907 1.077 1.907 2.185V19.5a2.25 2.25 0 0 1-2.25 2.25H6.75A2.25 2.25 0 0 1 4.5 19.5V6.257c0-1.108.806-2.057 1.907-2.185a48.208 48.208 0 0 1 1.927-.184"></path></svg><span>复制</span></button></div><div class="overflow-x-auto"><pre style="background:transparent;color:hsl(230, 8%, 24%);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.7;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1.25rem;margin:0;overflow:auto;border-radius:0.3em;font-size:0.875rem"><code class="language-python" style="white-space:pre;background:transparent;color:hsl(230, 8%, 24%);font-family:ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, monospace;direction:ltr;text-align:left;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">1</span><span class="token" style="color:hsl(230, 4%, 64%);font-style:italic"># 按语义分块</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">2</span><span></span><span class="token" style="color:hsl(301, 63%, 40%)">from</span><span> langchain</span><span class="token" style="color:hsl(230, 8%, 24%)">.</span><span>text_splitter </span><span class="token" style="color:hsl(301, 63%, 40%)">import</span><span> SemanticChunker
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">3</span>
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">4</span><span>semantic_splitter </span><span class="token" style="color:hsl(221, 87%, 60%)">=</span><span> SemanticChunker</span><span class="token" style="color:hsl(230, 8%, 24%)">(</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">5</span><span>    embeddings</span><span class="token" style="color:hsl(230, 8%, 24%)">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">6</span><span>    breakpoint_threshold_type</span><span class="token" style="color:hsl(221, 87%, 60%)">=</span><span class="token" style="color:hsl(119, 34%, 47%)">&quot;percentile&quot;</span><span class="token" style="color:hsl(230, 8%, 24%)">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">7</span><span>    breakpoint_threshold_amount</span><span class="token" style="color:hsl(221, 87%, 60%)">=</span><span class="token" style="color:hsl(35, 99%, 36%)">95</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">8</span><span></span><span class="token" style="color:hsl(230, 8%, 24%)">)</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">9</span>
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">10</span><span></span><span class="token" style="color:hsl(230, 4%, 64%);font-style:italic"># 按结构分块（Markdown）</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">11</span><span></span><span class="token" style="color:hsl(301, 63%, 40%)">from</span><span> langchain</span><span class="token" style="color:hsl(230, 8%, 24%)">.</span><span>text_splitter </span><span class="token" style="color:hsl(301, 63%, 40%)">import</span><span> MarkdownHeaderTextSplitter
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">12</span>
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">13</span><span>markdown_splitter </span><span class="token" style="color:hsl(221, 87%, 60%)">=</span><span> MarkdownHeaderTextSplitter</span><span class="token" style="color:hsl(230, 8%, 24%)">(</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">14</span><span>    headers_to_split_on</span><span class="token" style="color:hsl(221, 87%, 60%)">=</span><span class="token" style="color:hsl(230, 8%, 24%)">[</span><span class="token" style="color:hsl(230, 8%, 24%)">(</span><span class="token" style="color:hsl(119, 34%, 47%)">&quot;#&quot;</span><span class="token" style="color:hsl(230, 8%, 24%)">,</span><span> </span><span class="token" style="color:hsl(119, 34%, 47%)">&quot;Header 1&quot;</span><span class="token" style="color:hsl(230, 8%, 24%)">)</span><span class="token" style="color:hsl(230, 8%, 24%)">,</span><span> </span><span class="token" style="color:hsl(230, 8%, 24%)">(</span><span class="token" style="color:hsl(119, 34%, 47%)">&quot;##&quot;</span><span class="token" style="color:hsl(230, 8%, 24%)">,</span><span> </span><span class="token" style="color:hsl(119, 34%, 47%)">&quot;Header 2&quot;</span><span class="token" style="color:hsl(230, 8%, 24%)">)</span><span class="token" style="color:hsl(230, 8%, 24%)">]</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">15</span><span></span><span class="token" style="color:hsl(230, 8%, 24%)">)</span></code></pre></div></div></pre>
<h3 id="3-缓存策略" class="text-xl font-semibold mt-8 mb-3 text-slate-800 dark:text-slate-200 scroll-mt-24"><a href="#3-缓存策略" class="text-indigo-600 dark:text-indigo-400 no-underline hover:underline">3. 缓存策略</a></h3>
<pre><div class="relative group my-6 rounded-xl overflow-hidden border bg-slate-50 border-slate-200"><div class="flex items-center justify-between px-4 py-2 border-b bg-white border-slate-200"><span class="text-xs uppercase font-semibold tracking-wider text-slate-500">python</span><button class="flex items-center gap-1.5 px-3 py-1.5 text-xs font-medium rounded-lg transition-all text-slate-500 hover:text-slate-700 hover:bg-slate-200" aria-label="复制代码"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="w-3.5 h-3.5"><path stroke-linecap="round" stroke-linejoin="round" d="M15.666 3.888A2.25 2.25 0 0 0 13.5 2.25h-3c-1.03 0-1.9.693-2.166 1.638m7.332 0c.055.194.084.4.084.612v0a.75.75 0 0 1-.75.75H9a.75.75 0 0 1-.75-.75v0c0-.212.03-.418.084-.612m7.332 0c.646.049 1.288.11 1.927.184 1.1.128 1.907 1.077 1.907 2.185V19.5a2.25 2.25 0 0 1-2.25 2.25H6.75A2.25 2.25 0 0 1 4.5 19.5V6.257c0-1.108.806-2.057 1.907-2.185a48.208 48.208 0 0 1 1.927-.184"></path></svg><span>复制</span></button></div><div class="overflow-x-auto"><pre style="background:transparent;color:hsl(230, 8%, 24%);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.7;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1.25rem;margin:0;overflow:auto;border-radius:0.3em;font-size:0.875rem"><code class="language-python" style="white-space:pre;background:transparent;color:hsl(230, 8%, 24%);font-family:ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, monospace;direction:ltr;text-align:left;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">1</span><span class="token" style="color:hsl(301, 63%, 40%)">from</span><span> langchain</span><span class="token" style="color:hsl(230, 8%, 24%)">.</span><span>cache </span><span class="token" style="color:hsl(301, 63%, 40%)">import</span><span> InMemoryCache
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">2</span><span></span><span class="token" style="color:hsl(301, 63%, 40%)">import</span><span> langchain
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">3</span>
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">4</span><span></span><span class="token" style="color:hsl(230, 4%, 64%);font-style:italic"># 启用缓存</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">5</span><span>langchain</span><span class="token" style="color:hsl(230, 8%, 24%)">.</span><span>llm_cache </span><span class="token" style="color:hsl(221, 87%, 60%)">=</span><span> InMemoryCache</span><span class="token" style="color:hsl(230, 8%, 24%)">(</span><span class="token" style="color:hsl(230, 8%, 24%)">)</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">6</span>
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">7</span><span></span><span class="token" style="color:hsl(230, 4%, 64%);font-style:italic"># 或使用 Redis 缓存</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">8</span><span></span><span class="token" style="color:hsl(301, 63%, 40%)">from</span><span> langchain</span><span class="token" style="color:hsl(230, 8%, 24%)">.</span><span>cache </span><span class="token" style="color:hsl(301, 63%, 40%)">import</span><span> RedisCache
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">9</span><span></span><span class="token" style="color:hsl(301, 63%, 40%)">import</span><span> redis
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">10</span>
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">11</span><span>redis_client </span><span class="token" style="color:hsl(221, 87%, 60%)">=</span><span> redis</span><span class="token" style="color:hsl(230, 8%, 24%)">.</span><span>Redis</span><span class="token" style="color:hsl(230, 8%, 24%)">(</span><span>host</span><span class="token" style="color:hsl(221, 87%, 60%)">=</span><span class="token" style="color:hsl(119, 34%, 47%)">&#x27;localhost&#x27;</span><span class="token" style="color:hsl(230, 8%, 24%)">,</span><span> port</span><span class="token" style="color:hsl(221, 87%, 60%)">=</span><span class="token" style="color:hsl(35, 99%, 36%)">6379</span><span class="token" style="color:hsl(230, 8%, 24%)">)</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">12</span><span>langchain</span><span class="token" style="color:hsl(230, 8%, 24%)">.</span><span>llm_cache </span><span class="token" style="color:hsl(221, 87%, 60%)">=</span><span> RedisCache</span><span class="token" style="color:hsl(230, 8%, 24%)">(</span><span>redis_client</span><span class="token" style="color:hsl(230, 8%, 24%)">)</span></code></pre></div></div></pre>
<h2 id="安全与隐私" class="text-2xl font-semibold mt-12 mb-4 text-slate-900 dark:text-white border-b border-slate-200 dark:border-slate-700 pb-3 scroll-mt-24"><a href="#安全与隐私" class="text-indigo-600 dark:text-indigo-400 no-underline hover:underline">安全与隐私</a></h2>
<h3 id="数据脱敏" class="text-xl font-semibold mt-8 mb-3 text-slate-800 dark:text-slate-200 scroll-mt-24"><a href="#数据脱敏" class="text-indigo-600 dark:text-indigo-400 no-underline hover:underline">数据脱敏</a></h3>
<pre><div class="relative group my-6 rounded-xl overflow-hidden border bg-slate-50 border-slate-200"><div class="flex items-center justify-between px-4 py-2 border-b bg-white border-slate-200"><span class="text-xs uppercase font-semibold tracking-wider text-slate-500">python</span><button class="flex items-center gap-1.5 px-3 py-1.5 text-xs font-medium rounded-lg transition-all text-slate-500 hover:text-slate-700 hover:bg-slate-200" aria-label="复制代码"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="w-3.5 h-3.5"><path stroke-linecap="round" stroke-linejoin="round" d="M15.666 3.888A2.25 2.25 0 0 0 13.5 2.25h-3c-1.03 0-1.9.693-2.166 1.638m7.332 0c.055.194.084.4.084.612v0a.75.75 0 0 1-.75.75H9a.75.75 0 0 1-.75-.75v0c0-.212.03-.418.084-.612m7.332 0c.646.049 1.288.11 1.927.184 1.1.128 1.907 1.077 1.907 2.185V19.5a2.25 2.25 0 0 1-2.25 2.25H6.75A2.25 2.25 0 0 1 4.5 19.5V6.257c0-1.108.806-2.057 1.907-2.185a48.208 48.208 0 0 1 1.927-.184"></path></svg><span>复制</span></button></div><div class="overflow-x-auto"><pre style="background:transparent;color:hsl(230, 8%, 24%);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.7;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1.25rem;margin:0;overflow:auto;border-radius:0.3em;font-size:0.875rem"><code class="language-python" style="white-space:pre;background:transparent;color:hsl(230, 8%, 24%);font-family:ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, monospace;direction:ltr;text-align:left;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">1</span><span class="token" style="color:hsl(301, 63%, 40%)">import</span><span> re
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">2</span>
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">3</span><span></span><span class="token" style="color:hsl(301, 63%, 40%)">def</span><span> </span><span class="token" style="color:hsl(221, 87%, 60%)">desensitize_text</span><span class="token" style="color:hsl(230, 8%, 24%)">(</span><span>text</span><span class="token" style="color:hsl(230, 8%, 24%)">)</span><span class="token" style="color:hsl(230, 8%, 24%)">:</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">4</span><span>    </span><span class="token" style="color:hsl(230, 4%, 64%);font-style:italic"># 手机号脱敏</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">5</span><span>    text </span><span class="token" style="color:hsl(221, 87%, 60%)">=</span><span> re</span><span class="token" style="color:hsl(230, 8%, 24%)">.</span><span>sub</span><span class="token" style="color:hsl(230, 8%, 24%)">(</span><span class="token" style="color:hsl(119, 34%, 47%)">r&#x27;1[3-9]\d{9}&#x27;</span><span class="token" style="color:hsl(230, 8%, 24%)">,</span><span> </span><span class="token" style="color:hsl(301, 63%, 40%)">lambda</span><span> m</span><span class="token" style="color:hsl(230, 8%, 24%)">:</span><span> m</span><span class="token" style="color:hsl(230, 8%, 24%)">.</span><span>group</span><span class="token" style="color:hsl(230, 8%, 24%)">(</span><span class="token" style="color:hsl(230, 8%, 24%)">)</span><span class="token" style="color:hsl(230, 8%, 24%)">[</span><span class="token" style="color:hsl(230, 8%, 24%)">:</span><span class="token" style="color:hsl(35, 99%, 36%)">3</span><span class="token" style="color:hsl(230, 8%, 24%)">]</span><span> </span><span class="token" style="color:hsl(221, 87%, 60%)">+</span><span> </span><span class="token" style="color:hsl(119, 34%, 47%)">&#x27;****&#x27;</span><span> </span><span class="token" style="color:hsl(221, 87%, 60%)">+</span><span> m</span><span class="token" style="color:hsl(230, 8%, 24%)">.</span><span>group</span><span class="token" style="color:hsl(230, 8%, 24%)">(</span><span class="token" style="color:hsl(230, 8%, 24%)">)</span><span class="token" style="color:hsl(230, 8%, 24%)">[</span><span class="token" style="color:hsl(35, 99%, 36%)">7</span><span class="token" style="color:hsl(230, 8%, 24%)">:</span><span class="token" style="color:hsl(230, 8%, 24%)">]</span><span class="token" style="color:hsl(230, 8%, 24%)">,</span><span> text</span><span class="token" style="color:hsl(230, 8%, 24%)">)</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">6</span><span>    </span><span class="token" style="color:hsl(230, 4%, 64%);font-style:italic"># 身份证号脱敏</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">7</span><span>    text </span><span class="token" style="color:hsl(221, 87%, 60%)">=</span><span> re</span><span class="token" style="color:hsl(230, 8%, 24%)">.</span><span>sub</span><span class="token" style="color:hsl(230, 8%, 24%)">(</span><span class="token" style="color:hsl(119, 34%, 47%)">r&#x27;\d{17}[\dXx]&#x27;</span><span class="token" style="color:hsl(230, 8%, 24%)">,</span><span> </span><span class="token" style="color:hsl(301, 63%, 40%)">lambda</span><span> m</span><span class="token" style="color:hsl(230, 8%, 24%)">:</span><span> m</span><span class="token" style="color:hsl(230, 8%, 24%)">.</span><span>group</span><span class="token" style="color:hsl(230, 8%, 24%)">(</span><span class="token" style="color:hsl(230, 8%, 24%)">)</span><span class="token" style="color:hsl(230, 8%, 24%)">[</span><span class="token" style="color:hsl(230, 8%, 24%)">:</span><span class="token" style="color:hsl(35, 99%, 36%)">6</span><span class="token" style="color:hsl(230, 8%, 24%)">]</span><span> </span><span class="token" style="color:hsl(221, 87%, 60%)">+</span><span> </span><span class="token" style="color:hsl(119, 34%, 47%)">&#x27;********&#x27;</span><span> </span><span class="token" style="color:hsl(221, 87%, 60%)">+</span><span> m</span><span class="token" style="color:hsl(230, 8%, 24%)">.</span><span>group</span><span class="token" style="color:hsl(230, 8%, 24%)">(</span><span class="token" style="color:hsl(230, 8%, 24%)">)</span><span class="token" style="color:hsl(230, 8%, 24%)">[</span><span class="token" style="color:hsl(35, 99%, 36%)">14</span><span class="token" style="color:hsl(230, 8%, 24%)">:</span><span class="token" style="color:hsl(230, 8%, 24%)">]</span><span class="token" style="color:hsl(230, 8%, 24%)">,</span><span> text</span><span class="token" style="color:hsl(230, 8%, 24%)">)</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">8</span><span>    </span><span class="token" style="color:hsl(230, 4%, 64%);font-style:italic"># 邮箱脱敏</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">9</span><span>    text </span><span class="token" style="color:hsl(221, 87%, 60%)">=</span><span> re</span><span class="token" style="color:hsl(230, 8%, 24%)">.</span><span>sub</span><span class="token" style="color:hsl(230, 8%, 24%)">(</span><span class="token" style="color:hsl(119, 34%, 47%)">r&#x27;(\w{2})\w+@(\w+)&#x27;</span><span class="token" style="color:hsl(230, 8%, 24%)">,</span><span> </span><span class="token" style="color:hsl(119, 34%, 47%)">r&#x27;\1***@\2&#x27;</span><span class="token" style="color:hsl(230, 8%, 24%)">,</span><span> text</span><span class="token" style="color:hsl(230, 8%, 24%)">)</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">10</span><span>    </span><span class="token" style="color:hsl(301, 63%, 40%)">return</span><span> text
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">11</span>
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">12</span><span></span><span class="token" style="color:hsl(230, 4%, 64%);font-style:italic"># 处理前对文档进行脱敏</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">13</span><span>chunks </span><span class="token" style="color:hsl(221, 87%, 60%)">=</span><span> </span><span class="token" style="color:hsl(230, 8%, 24%)">[</span><span>desensitize_text</span><span class="token" style="color:hsl(230, 8%, 24%)">(</span><span>chunk</span><span class="token" style="color:hsl(230, 8%, 24%)">)</span><span> </span><span class="token" style="color:hsl(301, 63%, 40%)">for</span><span> chunk </span><span class="token" style="color:hsl(301, 63%, 40%)">in</span><span> chunks</span><span class="token" style="color:hsl(230, 8%, 24%)">]</span></code></pre></div></div></pre>
<h3 id="访问控制" class="text-xl font-semibold mt-8 mb-3 text-slate-800 dark:text-slate-200 scroll-mt-24"><a href="#访问控制" class="text-indigo-600 dark:text-indigo-400 no-underline hover:underline">访问控制</a></h3>
<pre><div class="relative group my-6 rounded-xl overflow-hidden border bg-slate-50 border-slate-200"><div class="flex items-center justify-between px-4 py-2 border-b bg-white border-slate-200"><span class="text-xs uppercase font-semibold tracking-wider text-slate-500">python</span><button class="flex items-center gap-1.5 px-3 py-1.5 text-xs font-medium rounded-lg transition-all text-slate-500 hover:text-slate-700 hover:bg-slate-200" aria-label="复制代码"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="w-3.5 h-3.5"><path stroke-linecap="round" stroke-linejoin="round" d="M15.666 3.888A2.25 2.25 0 0 0 13.5 2.25h-3c-1.03 0-1.9.693-2.166 1.638m7.332 0c.055.194.084.4.084.612v0a.75.75 0 0 1-.75.75H9a.75.75 0 0 1-.75-.75v0c0-.212.03-.418.084-.612m7.332 0c.646.049 1.288.11 1.927.184 1.1.128 1.907 1.077 1.907 2.185V19.5a2.25 2.25 0 0 1-2.25 2.25H6.75A2.25 2.25 0 0 1 4.5 19.5V6.257c0-1.108.806-2.057 1.907-2.185a48.208 48.208 0 0 1 1.927-.184"></path></svg><span>复制</span></button></div><div class="overflow-x-auto"><pre style="background:transparent;color:hsl(230, 8%, 24%);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.7;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1.25rem;margin:0;overflow:auto;border-radius:0.3em;font-size:0.875rem"><code class="language-python" style="white-space:pre;background:transparent;color:hsl(230, 8%, 24%);font-family:ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, monospace;direction:ltr;text-align:left;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">1</span><span class="token" style="color:hsl(301, 63%, 40%)">from</span><span> functools </span><span class="token" style="color:hsl(301, 63%, 40%)">import</span><span> wraps
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">2</span>
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">3</span><span></span><span class="token" style="color:hsl(301, 63%, 40%)">def</span><span> </span><span class="token" style="color:hsl(221, 87%, 60%)">require_permission</span><span class="token" style="color:hsl(230, 8%, 24%)">(</span><span>permission</span><span class="token" style="color:hsl(230, 8%, 24%)">)</span><span class="token" style="color:hsl(230, 8%, 24%)">:</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">4</span><span>    </span><span class="token" style="color:hsl(301, 63%, 40%)">def</span><span> </span><span class="token" style="color:hsl(221, 87%, 60%)">decorator</span><span class="token" style="color:hsl(230, 8%, 24%)">(</span><span>func</span><span class="token" style="color:hsl(230, 8%, 24%)">)</span><span class="token" style="color:hsl(230, 8%, 24%)">:</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">5</span><span>        </span><span class="token decorator annotation" style="color:hsl(230, 8%, 24%)">@wraps</span><span class="token" style="color:hsl(230, 8%, 24%)">(</span><span>func</span><span class="token" style="color:hsl(230, 8%, 24%)">)</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">6</span><span>        </span><span class="token" style="color:hsl(301, 63%, 40%)">def</span><span> </span><span class="token" style="color:hsl(221, 87%, 60%)">wrapper</span><span class="token" style="color:hsl(230, 8%, 24%)">(</span><span>user</span><span class="token" style="color:hsl(230, 8%, 24%)">,</span><span> </span><span class="token" style="color:hsl(221, 87%, 60%)">*</span><span>args</span><span class="token" style="color:hsl(230, 8%, 24%)">,</span><span> </span><span class="token" style="color:hsl(221, 87%, 60%)">**</span><span>kwargs</span><span class="token" style="color:hsl(230, 8%, 24%)">)</span><span class="token" style="color:hsl(230, 8%, 24%)">:</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">7</span><span>            </span><span class="token" style="color:hsl(301, 63%, 40%)">if</span><span> permission </span><span class="token" style="color:hsl(301, 63%, 40%)">not</span><span> </span><span class="token" style="color:hsl(301, 63%, 40%)">in</span><span> user</span><span class="token" style="color:hsl(230, 8%, 24%)">.</span><span>permissions</span><span class="token" style="color:hsl(230, 8%, 24%)">:</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">8</span><span>                </span><span class="token" style="color:hsl(301, 63%, 40%)">raise</span><span> PermissionError</span><span class="token" style="color:hsl(230, 8%, 24%)">(</span><span class="token" style="color:hsl(119, 34%, 47%)">&quot;Access denied&quot;</span><span class="token" style="color:hsl(230, 8%, 24%)">)</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">9</span><span>            </span><span class="token" style="color:hsl(301, 63%, 40%)">return</span><span> func</span><span class="token" style="color:hsl(230, 8%, 24%)">(</span><span>user</span><span class="token" style="color:hsl(230, 8%, 24%)">,</span><span> </span><span class="token" style="color:hsl(221, 87%, 60%)">*</span><span>args</span><span class="token" style="color:hsl(230, 8%, 24%)">,</span><span> </span><span class="token" style="color:hsl(221, 87%, 60%)">**</span><span>kwargs</span><span class="token" style="color:hsl(230, 8%, 24%)">)</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">10</span><span>        </span><span class="token" style="color:hsl(301, 63%, 40%)">return</span><span> wrapper
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">11</span><span>    </span><span class="token" style="color:hsl(301, 63%, 40%)">return</span><span> decorator
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">12</span>
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">13</span><span></span><span class="token decorator annotation" style="color:hsl(230, 8%, 24%)">@require_permission</span><span class="token" style="color:hsl(230, 8%, 24%)">(</span><span class="token" style="color:hsl(119, 34%, 47%)">&quot;knowledge:read&quot;</span><span class="token" style="color:hsl(230, 8%, 24%)">)</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">14</span><span></span><span class="token" style="color:hsl(301, 63%, 40%)">def</span><span> </span><span class="token" style="color:hsl(221, 87%, 60%)">query_knowledge_base</span><span class="token" style="color:hsl(230, 8%, 24%)">(</span><span>user</span><span class="token" style="color:hsl(230, 8%, 24%)">,</span><span> query</span><span class="token" style="color:hsl(230, 8%, 24%)">)</span><span class="token" style="color:hsl(230, 8%, 24%)">:</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">15</span><span>    </span><span class="token" style="color:hsl(230, 4%, 64%);font-style:italic"># 查询逻辑</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">16</span><span>    </span><span class="token" style="color:hsl(301, 63%, 40%)">pass</span></code></pre></div></div></pre>
<h2 id="最佳实践" class="text-2xl font-semibold mt-12 mb-4 text-slate-900 dark:text-white border-b border-slate-200 dark:border-slate-700 pb-3 scroll-mt-24"><a href="#最佳实践" class="text-indigo-600 dark:text-indigo-400 no-underline hover:underline">最佳实践</a></h2>
<h3 id="文档预处理清单" class="text-xl font-semibold mt-8 mb-3 text-slate-800 dark:text-slate-200 scroll-mt-24"><a href="#文档预处理清单" class="text-indigo-600 dark:text-indigo-400 no-underline hover:underline">文档预处理清单</a></h3>
<ul class="my-6 space-y-2 list-disc list-inside">
<li class="text-slate-600 dark:text-slate-300 marker:text-indigo-500"><input type="checkbox" disabled=""/> <!-- -->扫描件需先 OCR 识别</li>
<li class="text-slate-600 dark:text-slate-300 marker:text-indigo-500"><input type="checkbox" disabled=""/> <!-- -->去除页眉页脚和页码</li>
<li class="text-slate-600 dark:text-slate-300 marker:text-indigo-500"><input type="checkbox" disabled=""/> <!-- -->表格内容转换为结构化数据</li>
<li class="text-slate-600 dark:text-slate-300 marker:text-indigo-500"><input type="checkbox" disabled=""/> <!-- -->图片提取并添加描述</li>
<li class="text-slate-600 dark:text-slate-300 marker:text-indigo-500"><input type="checkbox" disabled=""/> <!-- -->敏感信息脱敏处理</li>
</ul>
<h3 id="持续优化" class="text-xl font-semibold mt-8 mb-3 text-slate-800 dark:text-slate-200 scroll-mt-24"><a href="#持续优化" class="text-indigo-600 dark:text-indigo-400 no-underline hover:underline">持续优化</a></h3>
<ol class="my-6 space-y-2 list-decimal list-inside">
<li class="text-slate-600 dark:text-slate-300 marker:text-indigo-500"><strong class="text-slate-900 dark:text-white font-semibold">用户反馈收集</strong>: 记录问答质量，标记错误回答</li>
<li class="text-slate-600 dark:text-slate-300 marker:text-indigo-500"><strong class="text-slate-900 dark:text-white font-semibold">增量更新</strong>: 定期处理新增文档，无需全量重建</li>
<li class="text-slate-600 dark:text-slate-300 marker:text-indigo-500"><strong class="text-slate-900 dark:text-white font-semibold">监控指标</strong>: 检索延迟、回答准确率、用户满意度</li>
<li class="text-slate-600 dark:text-slate-300 marker:text-indigo-500"><strong class="text-slate-900 dark:text-white font-semibold">A/B 测试</strong>: 对比不同 Embedding 模型和参数效果</li>
</ol>
<h2 id="常见问题" class="text-2xl font-semibold mt-12 mb-4 text-slate-900 dark:text-white border-b border-slate-200 dark:border-slate-700 pb-3 scroll-mt-24"><a href="#常见问题" class="text-indigo-600 dark:text-indigo-400 no-underline hover:underline">常见问题</a></h2>
<h3 id="q-如何处理扫描版-pdf" class="text-xl font-semibold mt-8 mb-3 text-slate-800 dark:text-slate-200 scroll-mt-24"><a href="#q-如何处理扫描版-pdf" class="text-indigo-600 dark:text-indigo-400 no-underline hover:underline">Q: 如何处理扫描版 PDF？</a></h3>
<p class="text-slate-600 dark:text-slate-300 leading-relaxed mb-4">使用 OCR 工具预处理：</p>
<pre><div class="relative group my-6 rounded-xl overflow-hidden border bg-slate-50 border-slate-200"><div class="flex items-center justify-between px-4 py-2 border-b bg-white border-slate-200"><span class="text-xs uppercase font-semibold tracking-wider text-slate-500">python</span><button class="flex items-center gap-1.5 px-3 py-1.5 text-xs font-medium rounded-lg transition-all text-slate-500 hover:text-slate-700 hover:bg-slate-200" aria-label="复制代码"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="w-3.5 h-3.5"><path stroke-linecap="round" stroke-linejoin="round" d="M15.666 3.888A2.25 2.25 0 0 0 13.5 2.25h-3c-1.03 0-1.9.693-2.166 1.638m7.332 0c.055.194.084.4.084.612v0a.75.75 0 0 1-.75.75H9a.75.75 0 0 1-.75-.75v0c0-.212.03-.418.084-.612m7.332 0c.646.049 1.288.11 1.927.184 1.1.128 1.907 1.077 1.907 2.185V19.5a2.25 2.25 0 0 1-2.25 2.25H6.75A2.25 2.25 0 0 1 4.5 19.5V6.257c0-1.108.806-2.057 1.907-2.185a48.208 48.208 0 0 1 1.927-.184"></path></svg><span>复制</span></button></div><div class="overflow-x-auto"><pre style="background:transparent;color:hsl(230, 8%, 24%);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.7;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1.25rem;margin:0;overflow:auto;border-radius:0.3em;font-size:0.875rem"><code class="language-python" style="white-space:pre;background:transparent;color:hsl(230, 8%, 24%);font-family:ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, monospace;direction:ltr;text-align:left;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">1</span><span class="token" style="color:hsl(301, 63%, 40%)">import</span><span> pytesseract
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">2</span><span></span><span class="token" style="color:hsl(301, 63%, 40%)">from</span><span> pdf2image </span><span class="token" style="color:hsl(301, 63%, 40%)">import</span><span> convert_from_path
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">3</span>
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">4</span><span>images </span><span class="token" style="color:hsl(221, 87%, 60%)">=</span><span> convert_from_path</span><span class="token" style="color:hsl(230, 8%, 24%)">(</span><span class="token" style="color:hsl(119, 34%, 47%)">&quot;scan.pdf&quot;</span><span class="token" style="color:hsl(230, 8%, 24%)">)</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">5</span><span>text </span><span class="token" style="color:hsl(221, 87%, 60%)">=</span><span> </span><span class="token" style="color:hsl(119, 34%, 47%)">&quot;\n&quot;</span><span class="token" style="color:hsl(230, 8%, 24%)">.</span><span>join</span><span class="token" style="color:hsl(230, 8%, 24%)">(</span><span class="token" style="color:hsl(230, 8%, 24%)">[</span><span>pytesseract</span><span class="token" style="color:hsl(230, 8%, 24%)">.</span><span>image_to_string</span><span class="token" style="color:hsl(230, 8%, 24%)">(</span><span>img</span><span class="token" style="color:hsl(230, 8%, 24%)">,</span><span> lang</span><span class="token" style="color:hsl(221, 87%, 60%)">=</span><span class="token" style="color:hsl(119, 34%, 47%)">&#x27;chi_sim+eng&#x27;</span><span class="token" style="color:hsl(230, 8%, 24%)">)</span><span> </span><span class="token" style="color:hsl(301, 63%, 40%)">for</span><span> img </span><span class="token" style="color:hsl(301, 63%, 40%)">in</span><span> images</span><span class="token" style="color:hsl(230, 8%, 24%)">]</span><span class="token" style="color:hsl(230, 8%, 24%)">)</span></code></pre></div></div></pre>
<h3 id="q-知识库更新如何增量处理" class="text-xl font-semibold mt-8 mb-3 text-slate-800 dark:text-slate-200 scroll-mt-24"><a href="#q-知识库更新如何增量处理" class="text-indigo-600 dark:text-indigo-400 no-underline hover:underline">Q: 知识库更新如何增量处理？</a></h3>
<pre><div class="relative group my-6 rounded-xl overflow-hidden border bg-slate-50 border-slate-200"><div class="flex items-center justify-between px-4 py-2 border-b bg-white border-slate-200"><span class="text-xs uppercase font-semibold tracking-wider text-slate-500">python</span><button class="flex items-center gap-1.5 px-3 py-1.5 text-xs font-medium rounded-lg transition-all text-slate-500 hover:text-slate-700 hover:bg-slate-200" aria-label="复制代码"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="w-3.5 h-3.5"><path stroke-linecap="round" stroke-linejoin="round" d="M15.666 3.888A2.25 2.25 0 0 0 13.5 2.25h-3c-1.03 0-1.9.693-2.166 1.638m7.332 0c.055.194.084.4.084.612v0a.75.75 0 0 1-.75.75H9a.75.75 0 0 1-.75-.75v0c0-.212.03-.418.084-.612m7.332 0c.646.049 1.288.11 1.927.184 1.1.128 1.907 1.077 1.907 2.185V19.5a2.25 2.25 0 0 1-2.25 2.25H6.75A2.25 2.25 0 0 1 4.5 19.5V6.257c0-1.108.806-2.057 1.907-2.185a48.208 48.208 0 0 1 1.927-.184"></path></svg><span>复制</span></button></div><div class="overflow-x-auto"><pre style="background:transparent;color:hsl(230, 8%, 24%);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.7;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1.25rem;margin:0;overflow:auto;border-radius:0.3em;font-size:0.875rem"><code class="language-python" style="white-space:pre;background:transparent;color:hsl(230, 8%, 24%);font-family:ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, monospace;direction:ltr;text-align:left;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">1</span><span class="token" style="color:hsl(230, 4%, 64%);font-style:italic"># 计算文档指纹</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">2</span><span></span><span class="token" style="color:hsl(301, 63%, 40%)">import</span><span> hashlib
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">3</span>
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">4</span><span></span><span class="token" style="color:hsl(301, 63%, 40%)">def</span><span> </span><span class="token" style="color:hsl(221, 87%, 60%)">get_doc_fingerprint</span><span class="token" style="color:hsl(230, 8%, 24%)">(</span><span>filepath</span><span class="token" style="color:hsl(230, 8%, 24%)">)</span><span class="token" style="color:hsl(230, 8%, 24%)">:</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">5</span><span>    </span><span class="token" style="color:hsl(301, 63%, 40%)">with</span><span> </span><span class="token" style="color:hsl(119, 34%, 47%)">open</span><span class="token" style="color:hsl(230, 8%, 24%)">(</span><span>filepath</span><span class="token" style="color:hsl(230, 8%, 24%)">,</span><span> </span><span class="token" style="color:hsl(119, 34%, 47%)">&#x27;rb&#x27;</span><span class="token" style="color:hsl(230, 8%, 24%)">)</span><span> </span><span class="token" style="color:hsl(301, 63%, 40%)">as</span><span> f</span><span class="token" style="color:hsl(230, 8%, 24%)">:</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">6</span><span>        </span><span class="token" style="color:hsl(301, 63%, 40%)">return</span><span> hashlib</span><span class="token" style="color:hsl(230, 8%, 24%)">.</span><span>md5</span><span class="token" style="color:hsl(230, 8%, 24%)">(</span><span>f</span><span class="token" style="color:hsl(230, 8%, 24%)">.</span><span>read</span><span class="token" style="color:hsl(230, 8%, 24%)">(</span><span class="token" style="color:hsl(230, 8%, 24%)">)</span><span class="token" style="color:hsl(230, 8%, 24%)">)</span><span class="token" style="color:hsl(230, 8%, 24%)">.</span><span>hexdigest</span><span class="token" style="color:hsl(230, 8%, 24%)">(</span><span class="token" style="color:hsl(230, 8%, 24%)">)</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">7</span>
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">8</span><span></span><span class="token" style="color:hsl(230, 4%, 64%);font-style:italic"># 只处理新增或修改的文档</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">9</span><span>existing_ids </span><span class="token" style="color:hsl(221, 87%, 60%)">=</span><span> </span><span class="token" style="color:hsl(119, 34%, 47%)">set</span><span class="token" style="color:hsl(230, 8%, 24%)">(</span><span>get_existing_ids</span><span class="token" style="color:hsl(230, 8%, 24%)">(</span><span class="token" style="color:hsl(230, 8%, 24%)">)</span><span class="token" style="color:hsl(230, 8%, 24%)">)</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.5rem;padding-right:1rem;text-align:right;user-select:none;color:hsl(230, 4%, 64%);font-size:0.75rem;font-style:italic">10</span><span>new_docs </span><span class="token" style="color:hsl(221, 87%, 60%)">=</span><span> </span><span class="token" style="color:hsl(230, 8%, 24%)">[</span><span>doc </span><span class="token" style="color:hsl(301, 63%, 40%)">for</span><span> doc </span><span class="token" style="color:hsl(301, 63%, 40%)">in</span><span> all_docs </span><span class="token" style="color:hsl(301, 63%, 40%)">if</span><span> doc</span><span class="token" style="color:hsl(230, 8%, 24%)">.</span><span class="token" style="color:hsl(119, 34%, 47%)">id</span><span> </span><span class="token" style="color:hsl(301, 63%, 40%)">not</span><span> </span><span class="token" style="color:hsl(301, 63%, 40%)">in</span><span> existing_ids</span><span class="token" style="color:hsl(230, 8%, 24%)">]</span></code></pre></div></div></pre>
<h3 id="q-如何处理超长文档" class="text-xl font-semibold mt-8 mb-3 text-slate-800 dark:text-slate-200 scroll-mt-24"><a href="#q-如何处理超长文档" class="text-indigo-600 dark:text-indigo-400 no-underline hover:underline">Q: 如何处理超长文档？</a></h3>
<p class="text-slate-600 dark:text-slate-300 leading-relaxed mb-4">采用分层摘要策略：</p>
<ol class="my-6 space-y-2 list-decimal list-inside">
<li class="text-slate-600 dark:text-slate-300 marker:text-indigo-500">段落级摘要</li>
<li class="text-slate-600 dark:text-slate-300 marker:text-indigo-500">章节级摘要</li>
<li class="text-slate-600 dark:text-slate-300 marker:text-indigo-500">文档级摘要</li>
<li class="text-slate-600 dark:text-slate-300 marker:text-indigo-500">构建树状索引结构</li>
</ol>
<h2 id="总结" class="text-2xl font-semibold mt-12 mb-4 text-slate-900 dark:text-white border-b border-slate-200 dark:border-slate-700 pb-3 scroll-mt-24"><a href="#总结" class="text-indigo-600 dark:text-indigo-400 no-underline hover:underline">总结</a></h2>
<p class="text-slate-600 dark:text-slate-300 leading-relaxed mb-4">本地知识库是企业 AI 应用的基础设施，通过合理的架构设计、性能优化和安全策略，可以构建高效、可靠的智能知识管理系统。</p>
<p class="text-slate-600 dark:text-slate-300 leading-relaxed mb-4">如需技术支持，请通过以下方式联系我们：</p>
<ul class="my-6 space-y-2 list-disc list-inside">
<li class="text-slate-600 dark:text-slate-300 marker:text-indigo-500">邮箱：<a href="mailto:c@m9ai.work" class="text-indigo-600 dark:text-indigo-400 no-underline hover:underline">c@m9ai.work</a></li>
<li class="text-slate-600 dark:text-slate-300 marker:text-indigo-500">官网：<a href="https://m9ai.work" class="text-indigo-600 dark:text-indigo-400 no-underline hover:underline" target="_blank" rel="noopener noreferrer">https://m9ai.work</a></li>
</ul></div></article><div class="mt-8 flex items-center justify-between pt-8 border-t border-slate-200 dark:border-slate-700" style="opacity:0"><a class="flex items-center gap-2 text-slate-500 hover:text-indigo-600 transition-colors" href="/zh/docs/"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="w-4 h-4"><path stroke-linecap="round" stroke-linejoin="round" d="M10.5 19.5 3 12m0 0 7.5-7.5M3 12h18"></path></svg><span>返回文档列表</span></a></div></main><aside class="hidden lg:block lg:col-span-2"><div class="sticky top-24"></div></aside></div></div></div><!--$--><!--/$--></main><footer class="relative bg-slate-900 dark:bg-black text-slate-300 overflow-hidden"><div class="absolute top-0 left-0 right-0 h-px bg-gradient-to-r from-transparent via-primary/50 to-transparent"></div><div class="container mx-auto px-4 sm:px-6 lg:px-8"><div class="py-16 lg:py-20"><div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-12 lg:gap-8"><div class="lg:col-span-2"><a class="inline-flex items-center gap-3 mb-6 group" href="/zh/"><div class="relative w-10 h-10 rounded-xl overflow-hidden shadow-lg group-hover:shadow-glow transition-shadow"><img alt="Logo" loading="lazy" decoding="async" data-nimg="fill" class="object-cover" style="position:absolute;height:100%;width:100%;left:0;top:0;right:0;bottom:0;color:transparent" src="/favicon.jpg"/></div><span class="text-xl font-bold text-white">Metasequoia AI</span></a><p class="text-slate-400 text-sm leading-relaxed mb-6 max-w-sm">Enterprise-grade AI solutions provider specializing in model deployment, application development and intelligent agent customization</p><div class="flex items-center gap-3"><div class="relative"><button class="w-10 h-10 flex items-center justify-center rounded-xl bg-slate-800 hover:bg-primary text-slate-400 hover:text-white transition-all" aria-label="微信公众号"><svg class="w-5 h-5" viewBox="0 0 24 24" fill="currentColor"><path d="M8.691 2.188C3.891 2.188 0 5.476 0 9.53c0 2.212 1.17 4.203 3.002 5.55a.59.59 0 0 1 .213.665l-.39 1.48c-.019.07-.048.141-.048.213 0 .163.13.295.29.295a.326.326 0 0 0 .167-.054l1.903-1.114a.864.864 0 0 1 .717-.098 10.16 10.16 0 0 0 2.837.403c.276 0 .543-.027.811-.05-.857-2.578.157-4.972 1.932-6.446 1.703-1.415 3.882-1.98 5.853-1.838-.576-3.583-4.196-6.348-8.596-6.348zM5.785 5.991c.642 0 1.162.529 1.162 1.18a1.17 1.17 0 0 1-1.162 1.178A1.17 1.17 0 0 1 4.623 7.17c0-.651.52-1.18 1.162-1.18zm5.813 0c.642 0 1.162.529 1.162 1.18a1.17 1.17 0 0 1-1.162 1.178 1.17 1.17 0 0 1-1.162-1.178c0-.651.52-1.18 1.162-1.18zm5.34 2.867c-1.797-.052-3.746.512-5.28 1.786-1.72 1.428-2.687 3.72-1.78 6.22.942 2.453 3.666 4.229 6.884 4.229.826 0 1.622-.12 2.361-.336a.722.722 0 0 1 .598.082l1.584.926a.272.272 0 0 0 .14.047c.134 0 .24-.111.24-.247 0-.06-.023-.12-.038-.177l-.327-1.233a.49.49 0 0 1-.011-.175.49.49 0 0 1 .189-.38C23.063 18.369 24 16.672 24 14.783c0-3.354-3.16-6.007-7.062-5.925zm-2.92 2.691c.535 0 .969.44.969.982a.976.976 0 0 1-.969.983.976.976 0 0 1-.969-.983c0-.542.434-.982.97-.982zm4.844 0c.535 0 .969.44.969.982a.976.976 0 0 1-.969.983.976.976 0 0 1-.969-.983c0-.542.434-.982.969-.982z"></path></svg></button></div><div class="relative"><button class="w-10 h-10 flex items-center justify-center rounded-xl bg-slate-800 hover:bg-primary text-slate-400 hover:text-white transition-all" aria-label="微信视频号"><svg class="w-5 h-5" viewBox="0 0 24 24" fill="currentColor"><path d="M17 10.5V7c0-.55-.45-1-1-1H4c-.55 0-1 .45-1 1v10c0 .55.45 1 1 1h12c.55 0 1-.45 1-1v-3.5l4 4v-11l-4 4z"></path></svg></button></div><a target="_blank" rel="noopener noreferrer" class="w-10 h-10 flex items-center justify-center rounded-xl bg-slate-800 hover:bg-primary text-slate-400 hover:text-white transition-all" aria-label="Email" href="mailto:c@m9ai.work"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="w-5 h-5"><path stroke-linecap="round" stroke-linejoin="round" d="M21.75 6.75v10.5a2.25 2.25 0 0 1-2.25 2.25h-15a2.25 2.25 0 0 1-2.25-2.25V6.75m19.5 0A2.25 2.25 0 0 0 19.5 4.5h-15a2.25 2.25 0 0 0-2.25 2.25m19.5 0v.243a2.25 2.25 0 0 1-1.07 1.916l-7.5 4.615a2.25 2.25 0 0 1-2.36 0L3.32 8.91a2.25 2.25 0 0 1-1.07-1.916V6.75"></path></svg></a></div></div><div><h3 class="text-white font-semibold mb-4">Services</h3><ul class="space-y-3"><li><a class="text-slate-400 hover:text-primary transition-colors text-sm" href="/zh/services/model-deployment/">Model Deployment</a></li><li><a class="text-slate-400 hover:text-primary transition-colors text-sm" href="/zh/services/model-application/">App Development</a></li><li><a class="text-slate-400 hover:text-primary transition-colors text-sm" href="/zh/services/agent-development/">AI Agents</a></li></ul></div><div><h3 class="text-white font-semibold mb-4">Studio</h3><ul class="space-y-3"><li><a class="text-slate-400 hover:text-primary transition-colors text-sm" href="/zh/contact/">Contact Us</a></li><li><a class="text-slate-400 hover:text-primary transition-colors text-sm" href="/zh/docs/">Docs</a></li><li><a class="text-slate-400 hover:text-primary transition-colors text-sm" href="/zh/store/">Store</a></li></ul></div><div><h3 class="text-white font-semibold mb-4">Legal</h3><ul class="space-y-3"><li><a class="text-slate-400 hover:text-primary transition-colors text-sm" href="/zh/privacy-policy/">Privacy Policy</a></li><li><a class="text-slate-400 hover:text-primary transition-colors text-sm" href="/zh/terms-of-service/">Terms of Service</a></li></ul></div></div></div><div class="py-6 border-t border-slate-800"><div class="flex flex-col md:flex-row items-center justify-between gap-4"><p class="text-slate-500 text-sm flex items-center gap-1">© <!-- -->2026<!-- --> <!-- -->Metasequoia AI<!-- -->. <!-- -->Made with<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="w-4 h-4 text-accent inline"><path stroke-linecap="round" stroke-linejoin="round" d="M21 8.25c0-2.485-2.099-4.5-4.688-4.5-1.935 0-3.597 1.126-4.312 2.733-.715-1.607-2.377-2.733-4.313-2.733C5.1 3.75 3 5.765 3 8.25c0 7.22 9 12 9 12s9-4.78 9-12Z"></path></svg>. All rights reserved.</p><button class="flex items-center gap-2 text-slate-400 hover:text-primary transition-colors text-sm group">Back to Top<span class="w-8 h-8 flex items-center justify-center rounded-lg bg-slate-800 group-hover:bg-primary group-hover:text-white transition-all"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="w-4 h-4"><path stroke-linecap="round" stroke-linejoin="round" d="M4.5 10.5 12 3m0 0 7.5 7.5M12 3v18"></path></svg></span></button></div></div></div></footer></div><script>
          if ('serviceWorker' in navigator) {
            window.addEventListener('load', function() {
              navigator.serviceWorker.register('/m9ai-sw.js').then(function(registration) {
                console.log('ServiceWorker registration successful with scope: ', registration.scope);
              }).catch(function(err) {
                console.log('ServiceWorker registration failed: ', err);
              });
            });
          }
        </script><script src="/_next/static/chunks/webpack-cc328fc80d1d92f9.js" id="_R_" async=""></script></body></html><script>(self.__next_f=self.__next_f||[]).push([0])</script><script>self.__next_f.push([1,"1:\"$Sreact.fragment\"\n4:I[50543,[],\"\"]\n5:I[94707,[],\"\"]\n7:I[76813,[],\"OutletBoundary\"]\n9:I[29979,[],\"AsyncMetadataOutlet\"]\nb:I[76813,[],\"ViewportBoundary\"]\nd:I[76813,[],\"MetadataBoundary\"]\ne:\"$Sreact.suspense\"\n10:I[70069,[],\"\"]\n:HL[\"/_next/static/css/b2aa10a3cb761d2f.css\",\"style\"]\n"])</script><script>self.__next_f.push([1,"0:{\"P\":null,\"b\":\"n-OaHVlfcIetbxWrGFmpn\",\"p\":\"\",\"c\":[\"\",\"en\",\"docs\",\"knowledge-base\",\"\"],\"i\":false,\"f\":[[[\"\",{\"children\":[[\"locale\",\"en\",\"d\"],{\"children\":[\"docs\",{\"children\":[[\"slug\",\"knowledge-base\",\"d\"],{\"children\":[\"__PAGE__\",{}]}]}]}]},\"$undefined\",\"$undefined\",true],[\"\",[\"$\",\"$1\",\"c\",{\"children\":[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/b2aa10a3cb761d2f.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}]],\"$L2\"]}],{\"children\":[[\"locale\",\"en\",\"d\"],[\"$\",\"$1\",\"c\",{\"children\":[null,\"$L3\"]}],{\"children\":[\"docs\",[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$L4\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L5\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}],{\"children\":[[\"slug\",\"knowledge-base\",\"d\"],[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$L4\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L5\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}],{\"children\":[\"__PAGE__\",[\"$\",\"$1\",\"c\",{\"children\":[\"$L6\",null,[\"$\",\"$L7\",null,{\"children\":[\"$L8\",[\"$\",\"$L9\",null,{\"promise\":\"$@a\"}]]}]]}],{},null,false]},null,false]},null,false]},null,false]},null,false],[\"$\",\"$1\",\"h\",{\"children\":[null,[[\"$\",\"$Lb\",null,{\"children\":\"$Lc\"}],null],[\"$\",\"$Ld\",null,{\"children\":[\"$\",\"div\",null,{\"hidden\":true,\"children\":[\"$\",\"$e\",null,{\"fallback\":null,\"children\":\"$Lf\"}]}]}]]}],false]],\"m\":\"$undefined\",\"G\":[\"$10\",[]],\"s\":false,\"S\":true}\n"])</script><script>self.__next_f.push([1,"11:I[44963,[\"6752\",\"static/chunks/6752-90baefdcb051c3c1.js\",\"2346\",\"static/chunks/2346-8f59889a5170c5da.js\",\"4345\",\"static/chunks/app/not-found-ffca88c5e945e772.js\"],\"default\"]\n12:I[33084,[\"6752\",\"static/chunks/6752-90baefdcb051c3c1.js\",\"1909\",\"static/chunks/1909-ac3fe94adcf1a95e.js\",\"2346\",\"static/chunks/2346-8f59889a5170c5da.js\",\"1278\",\"static/chunks/1278-1b71cee32080193b.js\",\"1399\",\"static/chunks/1399-c867858dd6d3be69.js\",\"8450\",\"static/chunks/app/%5Blocale%5D/layout-41f8cce3b90dae17.js\"],\"ThemeProvider\"]\n14:I[86653,[\"6752\",\"static/chunks/6752-90baefdcb051c3c1.js\",\"1909\",\"static/chunks/1909-ac3fe94adcf1a95e.js\",\"2346\",\"static/chunks/2346-8f59889a5170c5da.js\",\"1278\",\"static/chunks/1278-1b71cee32080193b.js\",\"1399\",\"static/chunks/1399-c867858dd6d3be69.js\",\"8450\",\"static/chunks/app/%5Blocale%5D/layout-41f8cce3b90dae17.js\"],\"default\"]\n2:[\"$\",\"html\",null,{\"lang\":\"$undefined\",\"children\":[\"$\",\"body\",null,{\"className\":\"antialiased\",\"children\":[\"$\",\"$L4\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L5\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":[[\"$\",\"$L11\",null,{}],[]],\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]}]}]\n"])</script><script>self.__next_f.push([1,"3:[\"$\",\"html\",null,{\"lang\":\"en\",\"children\":[[\"$\",\"head\",null,{\"children\":[[\"$\",\"meta\",null,{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1.0\"}],[\"$\",\"meta\",null,{\"name\":\"author\",\"content\":\"Metasequoia AI Studio\"}],[\"$\",\"link\",null,{\"rel\":\"manifest\",\"href\":\"/manifest.json\"}],[\"$\",\"meta\",null,{\"name\":\"theme-color\",\"content\":\"#000000\"}]]}],[\"$\",\"body\",null,{\"className\":\"antialiased\",\"children\":[[\"$\",\"$L12\",null,{\"children\":\"$L13\"}],[\"$\",\"script\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"\\n          if ('serviceWorker' in navigator) {\\n            window.addEventListener('load', function() {\\n              navigator.serviceWorker.register('/m9ai-sw.js').then(function(registration) {\\n                console.log('ServiceWorker registration successful with scope: ', registration.scope);\\n              }).catch(function(err) {\\n                console.log('ServiceWorker registration failed: ', err);\\n              });\\n            });\\n          }\\n        \"}}],[\"$\",\"$L14\",null,{}]]}]]}]\n"])</script><script>self.__next_f.push([1,"15:I[7765,[\"6752\",\"static/chunks/6752-90baefdcb051c3c1.js\",\"1909\",\"static/chunks/1909-ac3fe94adcf1a95e.js\",\"8267\",\"static/chunks/8267-dd1b836d6e85c2aa.js\",\"4078\",\"static/chunks/4078-f6abe0d6c13465e4.js\",\"8143\",\"static/chunks/app/%5Blocale%5D/docs/%5Bslug%5D/page-1401b27bc56f3599.js\"],\"default\"]\n16:T22a3,"])</script><script>self.__next_f.push([1,"\n# 本地知识库搭建指南\n\n## 概述\n\n本地知识库（Local Knowledge Base）是企业 AI 应用的核心基础设施。通过将企业私有文档、数据转化为可检索的知识，结合大语言模型的理解能力，实现智能问答、文档分析、知识挖掘等功能。\n\n## 核心架构\n\n```mermaid\nflowchart LR\n    subgraph Input[\"数据输入\"]\n        A[📄 文档输入\u003cbr/\u003ePDF/Word/等]\n        F[💬 用户提问\u003cbr/\u003e自然语言]\n    end\n    \n    subgraph Processing[\"处理层\"]\n        B[⚙️ 文档处理引擎\u003cbr/\u003e解析/分块/嵌入]\n        D[🔍 RAG 检索引擎\u003cbr/\u003e向量相似度搜索]\n    end\n    \n    subgraph Storage[\"存储层\"]\n        C[🗄️ 向量数据库\u003cbr/\u003eMilvus/PGVector]\n    end\n    \n    subgraph Output[\"输出层\"]\n        E[🤖 大语言模型\u003cbr/\u003e生成回答]\n    end\n    \n    A --\u003e B\n    B --\u003e C\n    C --\u003e D\n    F --\u003e D\n    D --\u003e E\n```\n\n## 环境准备\n\n### 系统要求\n\n- **CPU**: 4核及以上\n- **内存**: 16GB 及以上\n- **存储**: 100GB SSD 及以上\n- **GPU**: 可选，推荐用于 Embedding 加速\n\n### 依赖安装\n\n```bash\n# Python 环境\npython -m pip install langchain langchain-community\n\n# 向量数据库\npip install pymilvus  # 或 pgvector\n\n# 文档解析\npip install pypdf unstructured\n\n# Embedding 模型\npip install sentence-transformers\n```\n\n## 快速开始\n\n### 1. 初始化向量数据库\n\n使用 Milvus 作为向量存储：\n\n```bash\n# Docker 启动 Milvus\ndocker-compose -f milvus-standalone-docker-compose.yml up -d\n```\n\n或使用 PostgreSQL + pgvector：\n\n```sql\n-- 创建向量扩展\nCREATE EXTENSION IF NOT EXISTS vector;\n\n-- 创建知识库表\nCREATE TABLE knowledge_base (\n    id SERIAL PRIMARY KEY,\n    content TEXT,\n    embedding VECTOR(768),\n    metadata JSONB,\n    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP\n);\n```\n\n### 2. 文档处理流程\n\n```python\nfrom langchain.document_loaders import PyPDFLoader, DirectoryLoader\nfrom langchain.text_splitter import RecursiveCharacterTextSplitter\nfrom langchain.embeddings import HuggingFaceEmbeddings\nfrom langchain.vectorstores import Milvus\n\n# 加载文档\nloader = DirectoryLoader(\n    \"./documents\",\n    glob=\"**/*.pdf\",\n    loader_cls=PyPDFLoader\n)\ndocuments = loader.load()\n\n# 文档分块\ntext_splitter = RecursiveCharacterTextSplitter(\n    chunk_size=500,\n    chunk_overlap=50,\n    separators=[\"\\n\\n\", \"\\n\", \"。\", \"；\", \" \"]\n)\nchunks = text_splitter.split_documents(documents)\n\n# 创建 Embedding\nembeddings = HuggingFaceEmbeddings(\n    model_name=\"BAAI/bge-large-zh-v1.5\"\n)\n\n# 存入向量库\nvector_store = Milvus.from_documents(\n    documents=chunks,\n    embedding=embeddings,\n    connection_args={\"host\": \"localhost\", \"port\": \"19530\"},\n    collection_name=\"company_knowledge\"\n)\n```\n\n### 3. 检索与问答\n\n```python\nfrom langchain.chains import RetrievalQA\nfrom langchain.llms import OpenAI\n\n# 创建检索器\nretriever = vector_store.as_retriever(\n    search_type=\"similarity\",\n    search_kwargs={\"k\": 5}\n)\n\n# 构建 RAG 链\nqa_chain = RetrievalQA.from_chain_type(\n    llm=OpenAI(),\n    chain_type=\"stuff\",\n    retriever=retriever,\n    return_source_documents=True\n)\n\n# 提问\nresult = qa_chain({\"query\": \"公司的年假政策是什么？\"})\nprint(result[\"result\"])\n```\n\n## 高级配置\n\n### 混合检索策略\n\n结合向量检索与关键词检索，提升准确性：\n\n```python\nfrom langchain.retrievers import BM25Retriever, EnsembleRetriever\n\n# BM25 关键词检索\nbm25_retriever = BM25Retriever.from_documents(chunks)\nbm25_retriever.k = 5\n\n# 向量检索\nvector_retriever = vector_store.as_retriever(search_kwargs={\"k\": 5})\n\n# 融合检索\nensemble_retriever = EnsembleRetriever(\n    retrievers=[bm25_retriever, vector_retriever],\n    weights=[0.3, 0.7]\n)\n```\n\n### 重排序优化\n\n使用重排序模型提升检索质量：\n\n```python\nfrom langchain.retrievers import ContextualCompressionRetriever\nfrom langchain.retrievers.document_compressors import CrossEncoderReranker\n\n# 重排序模型\nreranker = CrossEncoderReranker(model=\"BAAI/bge-reranker-large\")\n\n# 压缩检索器\ncompression_retriever = ContextualCompressionRetriever(\n    base_compressor=reranker,\n    base_retriever=vector_retriever\n)\n```\n\n### 多租户隔离\n\n企业场景下的数据隔离方案：\n\n```python\n# 为每个租户创建独立 Collection\nfrom pymilvus import Collection, FieldSchema, CollectionSchema, DataType\n\ndef create_tenant_collection(tenant_id):\n    fields = [\n        FieldSchema(name=\"id\", dtype=DataType.INT64, is_primary=True),\n        FieldSchema(name=\"content\", dtype=DataType.VARCHAR, max_length=65535),\n        FieldSchema(name=\"embedding\", dtype=DataType.FLOAT_VECTOR, dim=768),\n        FieldSchema(name=\"metadata\", dtype=DataType.JSON),\n        FieldSchema(name=\"tenant_id\", dtype=DataType.VARCHAR, max_length=64)\n    ]\n    \n    schema = CollectionSchema(fields)\n    collection = Collection(f\"knowledge_{tenant_id}\", schema)\n    \n    # 创建索引\n    index_params = {\n        \"metric_type\": \"COSINE\",\n        \"index_type\": \"IVF_FLAT\",\n        \"params\": {\"nlist\": 1024}\n    }\n    collection.create_index(\"embedding\", index_params)\n    return collection\n```\n\n## 性能优化\n\n### 1. Embedding 模型选择\n\n| 模型 | 维度 | 语言 | 适用场景 |\n|------|------|------|----------|\n| BAAI/bge-large-zh | 1024 | 中文 | 通用中文场景 |\n| BAAI/bge-m3 | 1024 | 多语言 | 多语言混合 |\n| text-embedding-3 | 1536 | 多语言 | OpenAI 生态 |\n| m3e-base | 768 | 中文 | 轻量级应用 |\n\n### 2. 分块策略优化\n\n```python\n# 按语义分块\nfrom langchain.text_splitter import SemanticChunker\n\nsemantic_splitter = SemanticChunker(\n    embeddings,\n    breakpoint_threshold_type=\"percentile\",\n    breakpoint_threshold_amount=95\n)\n\n# 按结构分块（Markdown）\nfrom langchain.text_splitter import MarkdownHeaderTextSplitter\n\nmarkdown_splitter = MarkdownHeaderTextSplitter(\n    headers_to_split_on=[(\"#\", \"Header 1\"), (\"##\", \"Header 2\")]\n)\n```\n\n### 3. 缓存策略\n\n```python\nfrom langchain.cache import InMemoryCache\nimport langchain\n\n# 启用缓存\nlangchain.llm_cache = InMemoryCache()\n\n# 或使用 Redis 缓存\nfrom langchain.cache import RedisCache\nimport redis\n\nredis_client = redis.Redis(host='localhost', port=6379)\nlangchain.llm_cache = RedisCache(redis_client)\n```\n\n## 安全与隐私\n\n### 数据脱敏\n\n```python\nimport re\n\ndef desensitize_text(text):\n    # 手机号脱敏\n    text = re.sub(r'1[3-9]\\d{9}', lambda m: m.group()[:3] + '****' + m.group()[7:], text)\n    # 身份证号脱敏\n    text = re.sub(r'\\d{17}[\\dXx]', lambda m: m.group()[:6] + '********' + m.group()[14:], text)\n    # 邮箱脱敏\n    text = re.sub(r'(\\w{2})\\w+@(\\w+)', r'\\1***@\\2', text)\n    return text\n\n# 处理前对文档进行脱敏\nchunks = [desensitize_text(chunk) for chunk in chunks]\n```\n\n### 访问控制\n\n```python\nfrom functools import wraps\n\ndef require_permission(permission):\n    def decorator(func):\n        @wraps(func)\n        def wrapper(user, *args, **kwargs):\n            if permission not in user.permissions:\n                raise PermissionError(\"Access denied\")\n            return func(user, *args, **kwargs)\n        return wrapper\n    return decorator\n\n@require_permission(\"knowledge:read\")\ndef query_knowledge_base(user, query):\n    # 查询逻辑\n    pass\n```\n\n## 最佳实践\n\n### 文档预处理清单\n\n- [ ] 扫描件需先 OCR 识别\n- [ ] 去除页眉页脚和页码\n- [ ] 表格内容转换为结构化数据\n- [ ] 图片提取并添加描述\n- [ ] 敏感信息脱敏处理\n\n### 持续优化\n\n1. **用户反馈收集**: 记录问答质量，标记错误回答\n2. **增量更新**: 定期处理新增文档，无需全量重建\n3. **监控指标**: 检索延迟、回答准确率、用户满意度\n4. **A/B 测试**: 对比不同 Embedding 模型和参数效果\n\n## 常见问题\n\n### Q: 如何处理扫描版 PDF？\n\n使用 OCR 工具预处理：\n\n```python\nimport pytesseract\nfrom pdf2image import convert_from_path\n\nimages = convert_from_path(\"scan.pdf\")\ntext = \"\\n\".join([pytesseract.image_to_string(img, lang='chi_sim+eng') for img in images])\n```\n\n### Q: 知识库更新如何增量处理？\n\n```python\n# 计算文档指纹\nimport hashlib\n\ndef get_doc_fingerprint(filepath):\n    with open(filepath, 'rb') as f:\n        return hashlib.md5(f.read()).hexdigest()\n\n# 只处理新增或修改的文档\nexisting_ids = set(get_existing_ids())\nnew_docs = [doc for doc in all_docs if doc.id not in existing_ids]\n```\n\n### Q: 如何处理超长文档？\n\n采用分层摘要策略：\n1. 段落级摘要\n2. 章节级摘要  \n3. 文档级摘要\n4. 构建树状索引结构\n\n## 总结\n\n本地知识库是企业 AI 应用的基础设施，通过合理的架构设计、性能优化和安全策略，可以构建高效、可靠的智能知识管理系统。\n\n如需技术支持，请通过以下方式联系我们：\n- 邮箱：c@m9ai.work\n- 官网：https://m9ai.work\n"])</script><script>self.__next_f.push([1,"6:[\"$\",\"$L15\",null,{\"doc\":{\"slug\":\"knowledge-base\",\"title\":\"本地知识库搭建指南\",\"description\":\"学习如何构建企业级本地知识库，实现私有数据的智能检索与问答\",\"category\":\"进阶教程\",\"tags\":[\"知识库\",\"RAG\",\"向量数据库\",\"数据安全\"],\"updatedAt\":\"2025-02-09\",\"content\":\"$16\"},\"allDocs\":[{\"slug\":\"api-integration\",\"title\":\"API 集成开发指南\",\"category\":\"开发指南\"},{\"slug\":\"api-reference\",\"title\":\"API 文档\",\"category\":\"技术文档\"},{\"slug\":\"faq\",\"title\":\"常见问题\",\"category\":\"帮助中心\"},{\"slug\":\"introduction\",\"title\":\"欢迎使用水杉智境工作室\",\"category\":\"入门指南\"},{\"slug\":\"knowledge-base\",\"title\":\"本地知识库搭建指南\",\"category\":\"进阶教程\"},{\"slug\":\"model-deployment\",\"title\":\"模型部署指南\",\"category\":\"技术文档\"},{\"slug\":\"privacy-policy-en\",\"title\":\"privacy-policy-en\",\"category\":\"其他\"},{\"slug\":\"privacy-policy\",\"title\":\"privacy-policy\",\"category\":\"其他\"},{\"slug\":\"prompt-engineering\",\"title\":\"提示词工程最佳实践\",\"category\":\"进阶教程\"},{\"slug\":\"terms-of-service-en\",\"title\":\"terms-of-service-en\",\"category\":\"其他\"},{\"slug\":\"terms-of-service\",\"title\":\"terms-of-service\",\"category\":\"其他\"},{\"slug\":\"workflow\",\"title\":\"AI 工作流搭建实战\",\"category\":\"进阶教程\"}]}]\n"])</script><script>self.__next_f.push([1,"17:I[3338,[\"6752\",\"static/chunks/6752-90baefdcb051c3c1.js\",\"1909\",\"static/chunks/1909-ac3fe94adcf1a95e.js\",\"2346\",\"static/chunks/2346-8f59889a5170c5da.js\",\"1278\",\"static/chunks/1278-1b71cee32080193b.js\",\"1399\",\"static/chunks/1399-c867858dd6d3be69.js\",\"8450\",\"static/chunks/app/%5Blocale%5D/layout-41f8cce3b90dae17.js\"],\"default\"]\n"])</script><script>self.__next_f.push([1,"13:[\"$\",\"$L17\",null,{\"formats\":\"$undefined\",\"locale\":\"zh\",\"messages\":{\"meta\":{\"defaultTitle\":\"Metasequoia AI Studio\",\"defaultDescription\":\"Metasequoia AI Studio provides private deployment of large models, application development and intelligent agent customization services\",\"privacyPolicyTitle\":\"Privacy Policy\",\"privacyPolicyDescription\":\"This Privacy Policy explains how we collect, use, and safeguard your personal information when you use our website and services.\",\"termsOfServiceTitle\":\"Terms of Service\",\"termsOfServiceDescription\":\"These Terms of Service outline the rules and regulations governing the use of our website and services.\"},\"Contact\":{\"title\":\"Contact Us\",\"about\":{\"title\":\"About Us\",\"description\":\"Metasequoia AI Studio is a team focused on innovative technology solutions, dedicated to providing high-quality products and services to clients. We specialize in AGI application solutions, helping enterprises achieve digital and intelligent transformation.\"},\"founder\":{\"title\":\"Founder\",\"name\":\"Jian Zhang\",\"description\":\"Founder of Metasequoia AI Studio, with years of experience in software development and team management, specializing in AI technology applications and user experience. Has participated in the design and development of multiple large-scale projects, passionate about open-source technology and innovative solutions.\",\"viewProfile\":\"View Profile\"},\"contact\":{\"title\":\"Contact Us\",\"description\":\"If you have any questions or cooperation intentions, please contact us through the following methods:\",\"emailLabel\":\"Email\",\"phoneLabel\":\"Phone\",\"locationLabel\":\"Location\",\"wechatLabel\":\"WeChat\"}},\"title\":\"Metasequoia Studio\",\"subtitle\":\"Low-Cost AI Agent Service Platform\",\"description\":\"Providing customers with large model privatization deployment, application development and intelligent agent customization services\",\"learnMore\":\"Learn More →\",\"form\":\"Form\",\"home\":{\"title\":\"Welcome to Metasequoia Studio\",\"subtitle\":\"AI Solutions for Enterprise\",\"description\":\"We provide cutting-edge AI development services to help businesses transform digitally\",\"features\":{\"title\":\"Our Core Features\",\"items\":[{\"title\":\"Custom AI Models\",\"description\":\"Tailor-made large language models trained on your specific business data\"},{\"title\":\"Seamless Integration\",\"description\":\"Connect AI capabilities with your existing systems and workflows\"},{\"title\":\"Data Security\",\"description\":\"Enterprise-grade security protocols to protect your sensitive information\"},{\"title\":\"Scalable Architecture\",\"description\":\"Solutions that grow with your business needs and user base\"}]},\"testimonials\":{\"title\":\"What Our Clients Say\",\"items\":[{\"quote\":\"The AI solution transformed our customer service operations, reducing response times by 60%\",\"author\":\"CTO, Tech Innovations Inc.\"},{\"quote\":\"Their personalized approach to AI development helped us achieve our business goals faster than expected\",\"author\":\"CEO, Digital Transformation Group\"}]}},\"services\":{\"meta\":{\"title\":\"AI Services | Metasequoia Studio\",\"description\":\"Enterprise-grade AI solutions including private model deployment, application development and agent development\"},\"categories\":{\"aiService\":\"AI Service\"},\"pageTitle\":\"Our Services\",\"sectionTitle\":\"Our Core Services\",\"sectionDescription\":\"Providing comprehensive AI application development solutions to meet the needs of customers in different industries\",\"sectionTag\":\"Services\",\"viewAllServices\":\"View All Services\",\"cta\":{\"consultExpert\":\"Consult Expert\",\"readyForAIDescription\":\"Ready to start your AI transformation journey? Our expert team is ready to support you\",\"readyForAI\":\"Ready for AI\",\"consultSolution\":\"Consult Solution\",\"learnMore\":\"Learn More\"},\"learnMore\":\"Learn More\",\"sections\":{\"coreAdvantages\":\"Core Advantages\",\"scenarios\":\"Scenarios\",\"technicalFeatures\":\"Technical Features\",\"caseStudies\":\"Case Studies\"},\"backToList\":\"Back to Service List\",\"model-deployment\":{\"title\":\"Model Deployment\",\"description\":\"Deploy large language models in the customer's own server environment to ensure data security and privacy protection\",\"details\":\"Provide localized deployment solutions for mainstream large models, ensuring data security and privacy, supporting custom fine-tuning and performance optimization.\",\"coreAdvantages\":{\"supportAllModels\":{\"title\":\"Support for All Major Models\",\"description\":\"Local adaptation of 10+ mainstream large models including GPT series, LLaMA, Wenxin Yiyan, and iFlytek Spark\"},\"dataSecurity\":{\"title\":\"Data Security and Privacy Protection\",\"description\":\"Models deployed on customer's own servers with data never leaving local network\"},\"customization\":{\"title\":\"Deep Customization and Fine-tuning\",\"description\":\"Model fine-tuning based on customer business data to improve response quality\"},\"performanceOptimization\":{\"title\":\"Performance Optimization and Resource Management\",\"description\":\"Optimize model inference speed and reduce memory usage for different hardware\"}},\"scenarios\":{\"dataSensitiveIndustries\":{\"title\":\"Data-Sensitive Industries\",\"description\":\"Localized deployment solutions for finance, healthcare and other privacy-sensitive industries\"},\"localResponse\":{\"title\":\"Low-Latency Local Response\",\"description\":\"Local deployment meeting real-time interaction needs with 90% faster response\"}},\"technicalFeatures\":{\"toolchain\":{\"title\":\"One-Stop Deployment Toolchain\",\"description\":\"Automated deployment scripts and monitoring dashboard simplifying operations\"},\"hybridDeployment\":{\"title\":\"Hybrid Deployment Mode\",\"description\":\"Support local + cloud hybrid deployment balancing cost and performance\"}},\"cases\":[{\"title\":\"State-Owned Bank Intelligent Customer Service\",\"description\":\"Local model deployment handling 100,000+ daily customer inquiries with 92% accuracy\"}]},\"model-application\":{\"title\":\"LLM Application Development\",\"description\":\"Build enterprise-level applications based on large language models for intelligent customer service and content generation\",\"details\":\"Custom development of enterprise-level applications based on large models, integrating business system data for intelligent upgrading.\",\"coreAdvantages\":{\"multimodal\":{\"title\":\"Multimodal Interaction Capability\",\"description\":\"Comprehensive interaction experience integrating text, voice and images\"},\"lowCode\":{\"title\":\"Low-Code Rapid Development\",\"description\":\"Visual configuration platform reducing AI application development threshold\"},\"businessIntegration\":{\"title\":\"Deep Business System Integration\",\"description\":\"Seamless connection with CRM, ERP and other enterprise systems\"}},\"scenarios\":{\"intelligentInteraction\":{\"title\":\"Intelligent Interaction System\",\"description\":\"Enterprise intelligent customer service, voice assistants and other NLP interaction products\"},\"contentCreation\":{\"title\":\"Content Creation Platform\",\"description\":\"Automated copywriting generation, intelligent typesetting and multi-platform publishing\"},\"dataIntelligence\":{\"title\":\"Data Intelligence Analysis\",\"description\":\"Unstructured data parsing and intelligent report generation\"}},\"technicalFeatures\":{\"apiManagement\":{\"title\":\"Comprehensive API Management\",\"description\":\"Standardized interface design supporting high concurrent requests and traffic control\"},\"monitoring\":{\"title\":\"End-to-End Monitoring\",\"description\":\"User behavior analysis and model performance monitoring for continuous optimization\"}},\"cases\":[{\"title\":\"Online Education Intelligent Q\u0026A Platform\",\"description\":\"AI tutoring system for K12 education institutions covering 85% of common subject questions\"}]},\"agent-development\":{\"title\":\"AI Agent Development\",\"description\":\"Develop AI agents with autonomous decision-making capabilities to automate complex business processes\",\"details\":\"Custom development of AI agents with task planning, tool usage and autonomous learning capabilities to empower enterprise automation.\",\"coreAdvantages\":{\"autonomousPlanning\":{\"title\":\"Autonomous Task Planning\",\"description\":\"Decompose complex tasks based on goals and dynamically adjust execution strategies\"},\"toolIntegration\":{\"title\":\"Multi-Tool Integration\",\"description\":\"Connect internal enterprise systems and external APIs to expand agent capabilities\"},\"memoryManagement\":{\"title\":\"Long-Term Memory Management\",\"description\":\"Context understanding and long-term memory storage supporting coherent dialogue\"}},\"scenarios\":{\"automation\":{\"title\":\"Process Automation\",\"description\":\"Automated processing of repetitive tasks like expense reimbursement and contract review\"},\"complexProcess\":{\"title\":\"Complex Business Processes\",\"description\":\"Multi-step complex task processing for R\u0026D project management and market analysis\"}},\"technicalFeatures\":{\"decisionFramework\":{\"title\":\"Reinforcement Learning Decision Framework\",\"description\":\"Continuously optimize decision models based on environmental feedback\"},\"humanMachine\":{\"title\":\"Human-Machine Collaboration Mechanism\",\"description\":\"Human intervention at key decision nodes to ensure task accuracy\"}},\"cases\":[{\"title\":\"E-Commerce Intelligent Operations Assistant\",\"description\":\"Automated product listing, inventory management and marketing planning increasing efficiency by 60%\"}]},\"education\":{\"title\":\"Education Industry Solutions\",\"description\":\"AI-assisted teaching system with personalized learning path planning and intelligent Q\u0026A\"},\"finance\":{\"title\":\"Financial Risk Control System\",\"description\":\"Intelligent risk assessment and fraud detection to enhance financial security levels\"},\"healthcare\":{\"title\":\"Medical Auxiliary Diagnosis\",\"description\":\"Medical image analysis and auxiliary diagnosis suggestions to improve diagnostic accuracy\"}},\"navbar\":{\"logo\":\"Metasequoia AI\",\"services\":\"Services\",\"docs\":\"Docs\",\"store\":\"Store\",\"cta\":\"Get Started\",\"menu\":{\"home\":\"Home\",\"services\":\"Services\",\"cases\":\"Cases\",\"partners\":\"Partners\",\"contact\":\"Contact\",\"store\":\"Store\",\"docs\":\"Docs\"},\"language\":\"Language\",\"themeToggle\":\"Toggle Theme\"},\"search\":{\"buttonLabel\":\"Search\",\"placeholder\":\"Search services, docs, pages...\",\"loading\":\"Loading search index...\",\"results\":\"Search Results\",\"noResults\":\"No results found\",\"tryDifferentKeywords\":\"Try different keywords\",\"quickAccess\":\"Quick Access\",\"quickLinks\":{\"services\":\"Services\",\"docs\":\"Documentation\",\"store\":\"App Store\",\"contact\":\"Contact\"},\"proTip\":\"AI Smart Search\",\"proTipContent\":\"Supports fuzzy matching and semantic search, just type keywords to find relevant content quickly\",\"navigate\":\"Navigate\",\"select\":\"Select\",\"poweredBy\":\"AI-Powered Search\"},\"footer\":{\"logoAlt\":\"Metasequoia Studio Logo\",\"logoText\":\"Metasequoia AI\",\"copyright\":\"© 2025 Metasequoia Studio. All rights reserved.\",\"privacyPolicy\":\"Privacy Policy\",\"termsOfService\":\"Terms of Service\",\"contactUs\":\"Contact Us\",\"description\":\"Enterprise-grade AI solutions provider specializing in model deployment, application development and intelligent agent customization\",\"services\":\"Services\",\"company\":\"Studio\",\"legal\":\"Legal\",\"madeWith\":\"Made with\",\"allRightsReserved\":\". All rights reserved.\",\"backToTop\":\"Back to Top\",\"links\":{\"privacy\":\"Privacy Policy\",\"terms\":\"Terms of Service\",\"sitemap\":\"Sitemap\"},\"contact\":{\"email\":\"Contact Email\",\"phone\":\"Contact Phone\"}},\"common\":{\"buttons\":{\"submit\":\"Submit\",\"cancel\":\"Cancel\",\"save\":\"Save\",\"close\":\"Close\",\"learnMore\":\"Learn More\"},\"errors\":{\"networkError\":\"Network error, please try again later\",\"serverError\":\"Server error, please contact administrator\",\"notFound\":\"Resource not found\",\"permissionDenied\":\"Permission denied\"},\"notifications\":{\"info\":\"Information\",\"warning\":\"Warning\",\"success\":\"Success\",\"error\":\"Error\",\"confirmDelete\":\"Are you sure you want to delete this item?\"},\"validation\":{\"required\":\"This field is required\",\"email\":\"Please enter a valid email address\",\"minLength\":\"Minimum length is {min} characters\",\"maxLength\":\"Maximum length is {max} characters\",\"pattern\":\"Please match the required format\",\"numeric\":\"Please enter a number\",\"url\":\"Please enter a valid URL\"},\"labels\":{\"search\":\"Search\",\"filter\":\"Filter\",\"sort\":\"Sort\",\"loading\":\"Loading...\",\"error\":\"Error\",\"success\":\"Success\",\"confirm\":\"Confirm\"}},\"contact\":{\"title\":\"Contact Us\",\"submit\":\"Send Message\",\"form\":{\"nameLabel\":\"Name\",\"namePlaceholder\":\"Please enter your name\",\"contactLabel\":\"Contact Information\",\"contactPlaceholder\":\"Phone or email\",\"messageLabel\":\"Message\",\"messagePlaceholder\":\"Please briefly describe your needs\",\"submitButton\":\"Submit Collaboration Request\"}},\"hero\":{\"badge\":\"AI-Powered Solutions\",\"titleLine1\":\"Transform Your\",\"titleLine2\":\"Business with AI\",\"description\":\"Enterprise-grade AI solutions for model deployment, application development, and intelligent agent customization. Scale your business with cutting-edge technology.\",\"cta\":{\"explore\":\"Explore Services\",\"docs\":\"View Documentation\"},\"stats\":{\"clients\":\"Enterprise Clients\",\"uptime\":\"Uptime SLA\",\"support\":\"Expert Support\",\"efficiency\":\"Efficiency Gain\"}},\"theme\":{\"title\":\"Theme\",\"light\":\"Light\",\"dark\":\"Dark\",\"system\":\"System\"},\"cta\":{\"explore\":\"Explore Services\",\"docs\":\"View Documentation\"},\"consultation\":{\"sectionTag\":\"Limited Time Free\",\"sectionTitle\":\"Free AI Application Consultation\",\"sectionDescription\":\"Unsure how to AI-enable your business? Our experts offer a free 30-minute consultation to help you identify scenarios, assess feasibility, and plan implementation\",\"badge\":\"Now Open - Limited Time\",\"valueProps\":{\"free\":\"Free Consultation\",\"response\":\"Response within 2 hours\",\"expert\":\"1-on-1 Expert Advice\",\"noObligation\":\"No Obligations\"},\"form\":{\"title\":\"Book Your Free Consultation\",\"subtitle\":\"Fill in the information below so our consultants can serve you better\",\"nameLabel\":\"Your Name\",\"namePlaceholder\":\"Enter your name\",\"companyLabel\":\"Company Name\",\"companyPlaceholder\":\"Enter company name\",\"phoneLabel\":\"Phone Number\",\"phonePlaceholder\":\"Enter phone number\",\"businessTypeLabel\":\"Business Type\",\"businessTypePlaceholder\":\"Select business type\",\"painPointLabel\":\"Pain Points or Needs\",\"painPointPlaceholder\":\"Briefly describe your business scenario and the problems you want to solve...\",\"submitButton\":\"Book Free Consultation Now\",\"submitting\":\"Submitting...\",\"privacyNotice\":\"By submitting, you agree to our privacy policy. We will not share your information with third parties\"},\"process\":{\"title\":\"Service Process\",\"step1\":{\"title\":\"Submit Request\",\"desc\":\"Fill in basic info, response within 2 hours\"},\"step2\":{\"title\":\"Deep Dive\",\"desc\":\"30-minute 1-on-1 expert consultation\"},\"step3\":{\"title\":\"Solution Delivery\",\"desc\":\"Custom proposal within 3 business days\"},\"step4\":{\"title\":\"Your Decision\",\"desc\":\"Zero pressure, you decide whether to proceed\"}},\"faq\":{\"title\":\"Frequently Asked Questions\",\"q1\":\"What does the free consultation include?\",\"a1\":\"Our free consultation includes: 1) AI feasibility analysis for your business scenario; 2) Technical solution recommendations; 3) ROI estimation; 4) Implementation roadmap. The entire process takes about 30-45 minutes of in-depth discussion.\",\"q2\":\"Am I obligated to purchase services after the consultation?\",\"a2\":\"Absolutely not. The free consultation comes with no strings attached. You can decide whether to work with us based entirely on your own needs. Our goal is to help you clarify your AI application strategy—even if you don't choose us, we hope it's helpful.\",\"q3\":\"What is the background of your consultants?\",\"a3\":\"Our consultants come from well-known tech companies with 5+ years of AI project implementation experience, serving industries including finance, healthcare, manufacturing, and retail—helping 100+ companies complete AI transformation.\",\"q4\":\"How soon will I hear back?\",\"a4\":\"After submitting the form, we'll contact you within 2 business hours to arrange consultant matching. For urgent needs, please note in the remarks and we'll prioritize your request.\"},\"trust\":{\"title\":\"Trusted by 100+ Enterprise Clients\",\"subtitle\":\"Spanning finance, healthcare, manufacturing, retail and more\"},\"success\":{\"title\":\"Booking Successful!\",\"message\":\"Our consultant will contact you within 2 business hours. Please keep your phone available\"}},\"collaboration\":{\"sectionTag\":\"Get In Touch\",\"sectionTitle\":\"Collaborate Now\",\"sectionDescription\":\"Fill out the form or contact us through the following methods, and we will communicate with you as soon as possible\",\"form\":{\"nameLabel\":\"Name\",\"namePlaceholder\":\"Please enter your name\",\"contactLabel\":\"Contact Information\",\"contactPlaceholder\":\"Phone or email\",\"messageLabel\":\"Message\",\"messagePlaceholder\":\"Please briefly describe your needs\",\"submitButton\":\"Submit Collaboration Request\",\"submitting\":\"Submitting...\"},\"submitSuccess\":{\"title\":\"Submission Successful!\",\"message\":\"Thank you for your inquiry, our service consultant will contact you within 1-2 business days\"},\"sendAnother\":\"Send Another Message\",\"toast\":{\"success\":\"Submission Successful!\"},\"contact\":{\"wechat\":\"Scan WeChat QR Code\",\"scanQR\":\"Scan QR code to add on WeChat\",\"email\":\"Send Email\",\"responseTime\":\"We will reply to you within 1-2 business days\"}},\"partners\":{\"title\":\"Technology Partners\",\"description\":\"Establish strategic cooperation with industry-leading enterprises to jointly promote AI technology innovation and application\",\"sectionTag\":\"Our Partners\",\"sectionTitle\":\"Technology Partners\",\"sectionDescription\":\"Developed based on open source frameworks such as LangChain and FastAPI\",\"learnMore\":\"Learn More\",\"joinPartners\":\"Want to become a partner?\",\"contactUs\":\"Contact us\",\"companies\":{\"langchain\":{\"description\":\"Leading large language model application development framework\"},\"fastapi\":{\"description\":\"High-performance API development framework\"},\"dify\":{\"description\":\"Low-code/no-code AI application development platform\"},\"nextjs\":{\"description\":\"SEO-friendly full-stack application development framework\"}}},\"cases\":{\"sectionTag\":\"Success Stories\",\"sectionTitle\":\"Case Studies\",\"sectionDescription\":\"Explore our successfully implemented projects using large model technology\",\"viewDetails\":\"View Details →\",\"studies\":[{\"category\":\"Enterprise Services\",\"title\":\"Intelligent Customer Service System\",\"description\":\"LLM-based intelligent customer service solution increasing satisfaction by 30%\",\"challenge\":\"A large e-commerce enterprise faced high customer service costs, slow response times, and unstable service quality\",\"solution\":\"Deployed private LLM customer service system, enabling 7×24 intelligent responses with multi-turn dialogue and sentiment analysis\",\"results\":[\"Customer satisfaction increased by 30%\",\"Human agent workload reduced by 60%\",\"Average response time reduced from 5 minutes to 10 seconds\",\"Issue resolution rate improved to 92%\"],\"technologies\":[\"GPT-4\",\"RAG\",\"Sentiment Analysis\",\"Knowledge Graph\"]},{\"category\":\"Healthcare\",\"title\":\"Medical Data Analysis Platform\",\"description\":\"AI-powered medical data analysis assisting doctor diagnosis decisions\",\"challenge\":\"A tertiary hospital with over 10,000 daily outpatient visits, doctors under high diagnostic pressure, time-consuming medical records\",\"solution\":\"Built medical AI assistant integrated with EMR system, providing diagnostic suggestions and treatment plan references\",\"results\":[\"Medical record writing efficiency improved 3x\",\"Diagnostic accuracy increased by 15%\",\"Daily patient capacity increased by 25%\",\"Patient waiting time reduced by 40%\"],\"technologies\":[\"Medical NLP\",\"Knowledge Graph\",\"Multimodal Analysis\",\"Privacy Computing\"]},{\"category\":\"FinTech\",\"title\":\"Financial Risk Control System\",\"description\":\"Real-time transaction monitoring with 98% accuracy in anomaly detection\",\"challenge\":\"A bank suffered severe credit card fraud losses, traditional rule-based engines had high false positive rates\",\"solution\":\"AI-powered intelligent risk control system analyzing transaction behavior in real-time, dynamically adjusting risk strategies\",\"results\":[\"Fraud detection accuracy reached 98%\",\"False positive rate reduced by 70%\",\"Risk response time shortened to milliseconds\",\"Annual fraud losses reduced by 80M\"],\"technologies\":[\"Time Series Analysis\",\"Graph Neural Networks\",\"Anomaly Detection\",\"Federated Learning\"]},{\"category\":\"Online Education\",\"title\":\"Educational Content Generation Tool\",\"description\":\"Automatically generate personalized learning content for different learning styles\",\"challenge\":\"Education and training institutions struggled with slow content production, unable to meet personalized teaching needs\",\"solution\":\"AI teaching assistant generating courseware, exercises, and video scripts with one click, supporting multiple difficulty levels\",\"results\":[\"Content production efficiency improved 10x\",\"Course development cycle shortened from 2 weeks to 2 days\",\"Student completion rate increased by 35%\",\"Teacher preparation time saved by 50%\"],\"technologies\":[\"Content Generation\",\"Personalized Recommendation\",\"Knowledge Tracing\",\"Auto Assessment\"]},{\"category\":\"Architecture\",\"title\":\"AI-Assisted Architectural Design Platform\",\"description\":\"Intelligent design generation and optimization for building energy consumption and spatial layout\",\"challenge\":\"An architectural design institute faced long project cycles, frequent design changes, and energy optimization relying on experience\",\"solution\":\"AI architectural design assistant generating multiple scheme comparisons based on requirements, real-time energy consumption calculation\",\"results\":[\"Design cycle shortened by 50%\",\"Building energy consumption reduced by 20% on average\",\"Client satisfaction increased by 45%\",\"Design changes reduced by 60%\"],\"technologies\":[\"Generative Design\",\"BIM Integration\",\"Energy Simulation\",\"Spatial Optimization\"]},{\"category\":\"Smart Manufacturing\",\"title\":\"Industrial Quality Inspection Agent\",\"description\":\"AI vision inspection system for real-time defect detection and early warning\",\"challenge\":\"An auto parts factory had low manual inspection efficiency, high miss rates, and difficult quality traceability\",\"solution\":\"Deployed AI vision quality inspection system, real-time multi-station detection, automatic defect classification\",\"results\":[\"Inspection efficiency improved 8x\",\"Miss rate reduced from 3% to 0.1%\",\"Production line downtime reduced by 40%\",\"Quality traceability time reduced from hours to seconds\"],\"technologies\":[\"Computer Vision\",\"Edge Computing\",\"Digital Twin\",\"Predictive Maintenance\"]},{\"category\":\"Law Firm\",\"title\":\"Legal Document Intelligent Review System\",\"description\":\"Automated contract review and legal research to improve lawyer productivity\",\"challenge\":\"A large law firm faced heavy contract review workload, time-consuming legal research, and scattered knowledge management\",\"solution\":\"Legal AI assistant for intelligent contract clause review, automatic matching of relevant cases and regulations\",\"results\":[\"Contract review efficiency improved 5x\",\"Legal research time reduced by 80%\",\"Contract risk identification accuracy reached 95%\",\"Junior lawyer training cycle shortened by 50%\"],\"technologies\":[\"Legal NLP\",\"Knowledge Graph\",\"Intelligent Retrieval\",\"Document Analysis\"]},{\"category\":\"Accounting\",\"title\":\"Intelligent Audit Analysis Platform\",\"description\":\"AI-driven financial data analysis, automatic identification of abnormal transactions and risks\",\"challenge\":\"Accounting firms had many audit projects, large data processing volumes, limited coverage of manual sampling audits\",\"solution\":\"Intelligent audit system, full data analysis, automatic anomaly flagging, audit recommendation generation\",\"results\":[\"Audit efficiency improved 4x\",\"Abnormal transaction detection rate increased to 96%\",\"Audit coverage from sampling to full-scale\",\"Audit report generation time reduced by 70%\"],\"technologies\":[\"Financial NLP\",\"Anomaly Detection\",\"Data Mining\",\"Intelligent Report Generation\"]}]},\"Store\":{\"title\":\"App Store\",\"description\":\"Explore our AI applications to enhance your productivity and creativity\",\"searchPlaceholder\":\"Search apps...\",\"types\":{\"all\":\"All Types\",\"miniProgram\":\"Mini Program\",\"h5\":\"H5\",\"app\":\"App\"},\"categories\":{\"all\":\"All Categories\",\"tools\":\"Tools\",\"creativity\":\"Creativity\",\"development\":\"Development\",\"business\":\"Business\"},\"noAppsFound\":\"No matching apps found\",\"clearFilters\":\"Clear filters\",\"showingResults\":\"Showing {count} of {total} apps\",\"tryAdjustingFilters\":\"Try adjusting your search or filters\",\"meta\":{\"title\":\"App Store | Metasequoia Studio\",\"description\":\"Explore our AI applications to enhance your productivity and creativity\"}},\"Docs\":{\"loading\":\"Loading document...\",\"meta\":{\"title\":\"Documentation | Metasequoia Studio\",\"description\":\"Metasequoia Studio Documentation Center - Product guides, tutorials and technical reference\"},\"errors\":{\"title\":\"Error\",\"loadFailed\":\"Failed to load document\",\"notFound\":\"Document not found\"},\"search\":{\"placeholder\":\"Search documentation...\",\"noResults\":\"No matching documents found\",\"tryDifferent\":\"Try different keywords\"},\"categories\":{\"all\":\"All\",\"gettingStarted\":\"Getting Started\",\"technical\":\"Technical Docs\",\"help\":\"Help\"}}},\"now\":\"$undefined\",\"timeZone\":\"UTC\",\"children\":\"$L18\"}]\n"])</script><script>self.__next_f.push([1,"19:I[25554,[\"6752\",\"static/chunks/6752-90baefdcb051c3c1.js\",\"1909\",\"static/chunks/1909-ac3fe94adcf1a95e.js\",\"2346\",\"static/chunks/2346-8f59889a5170c5da.js\",\"1278\",\"static/chunks/1278-1b71cee32080193b.js\",\"1399\",\"static/chunks/1399-c867858dd6d3be69.js\",\"8450\",\"static/chunks/app/%5Blocale%5D/layout-41f8cce3b90dae17.js\"],\"default\"]\n1a:I[821,[\"6752\",\"static/chunks/6752-90baefdcb051c3c1.js\",\"1909\",\"static/chunks/1909-ac3fe94adcf1a95e.js\",\"2346\",\"static/chunks/2346-8f59889a5170c5da.js\",\"1278\",\"static/chunks/1278-1b71cee32080193b.js\",\"1399\",\"static/chunks/1399-c867858dd6d3be69.js\",\"8450\",\"static/chunks/app/%5Blocale%5D/layout-41f8cce3b90dae17.js\"],\"default\"]\n18:[\"$\",\"div\",null,{\"className\":\"flex flex-col min-h-screen\",\"children\":[[\"$\",\"$L19\",null,{}],[\"$\",\"main\",null,{\"className\":\"flex-grow\",\"children\":[\"$\",\"$L4\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L5\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]}],[\"$\",\"$L1a\",null,{}]]}]\n"])</script><script>self.__next_f.push([1,"c:[[\"$\",\"meta\",\"0\",{\"charSet\":\"utf-8\"}],[\"$\",\"meta\",\"1\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}]]\n8:null\n"])</script><script>self.__next_f.push([1,"1b:I[82435,[],\"IconMark\"]\n"])</script><script>self.__next_f.push([1,"a:{\"metadata\":[[\"$\",\"title\",\"0\",{\"children\":\"本地知识库搭建指南 | 文档中心\"}],[\"$\",\"meta\",\"1\",{\"name\":\"description\",\"content\":\"学习如何构建企业级本地知识库，实现私有数据的智能检索与问答\"}],[\"$\",\"link\",\"2\",{\"rel\":\"canonical\",\"href\":\"/en/docs/knowledge-base\"}],[\"$\",\"meta\",\"3\",{\"property\":\"og:title\",\"content\":\"Metasequoia Studio\"}],[\"$\",\"meta\",\"4\",{\"property\":\"og:description\",\"content\":\"Providing customers with large model privatization deployment, application development and intelligent agent customization services\"}],[\"$\",\"meta\",\"5\",{\"property\":\"og:image\",\"content\":\"http://localhost:3000/favicon.jpg\"}],[\"$\",\"meta\",\"6\",{\"property\":\"og:type\",\"content\":\"website\"}],[\"$\",\"meta\",\"7\",{\"name\":\"twitter:card\",\"content\":\"summary_large_image\"}],[\"$\",\"meta\",\"8\",{\"name\":\"twitter:title\",\"content\":\"Metasequoia Studio\"}],[\"$\",\"meta\",\"9\",{\"name\":\"twitter:description\",\"content\":\"Providing customers with large model privatization deployment, application development and intelligent agent customization services\"}],[\"$\",\"meta\",\"10\",{\"name\":\"twitter:image\",\"content\":\"http://localhost:3000/favicon.jpg\"}],[\"$\",\"link\",\"11\",{\"rel\":\"icon\",\"href\":\"/favicon.jpg\"}],[\"$\",\"$L1b\",\"12\",{}]],\"error\":null,\"digest\":\"$undefined\"}\n"])</script><script>self.__next_f.push([1,"f:\"$a:metadata\"\n"])</script></body></html>